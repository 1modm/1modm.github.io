<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Scapy &middot; M
    
  </title>

  
    <meta name="description" content="Scapy notes and examples"/>
    <meta name="keywords" content="">
  
  <meta name="author" content="Heiswayi Nrird">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@1_mod_m">
  <meta name="twitter:creator" content="@1_mod_m">
  
    <meta name="twitter:title" content="Scapy">
    <meta name="twitter:description" content="Scapy notes and examples">
  

  <meta property="og:type" content="website"/>
  
    <meta property="og:title" content="Scapy"/>
    <meta property="og:url" content="/Scapy.html"/>
    <meta property="og:description" content="Scapy notes and examples"/>
    <meta property="og:site_name" content="Scapy"/>
  

  <link rel="apple-touch-icon" sizes="57x57" href="/public/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/public/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/public/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/public/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/public/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/public/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/public/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/public/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/public/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/public/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/public/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/public/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/public/icons/favicon-16x16.png">
  <link rel="manifest" href="/public/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#f3f3f3">
  <meta name="msapplication-TileImage" content="/public/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="aSavCGGU0uSN5HEHnI7ZiMqVKxn7mfUPCGMVJvmDQ1w" />
  <meta name="wot-verification" content="6da2597a332a1fadad8f"/>

  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/public/css/normalize.css">
  <link rel="stylesheet" href="/public/css/style.css">

  <script src="/public/js/modernizr.custom.js"></script>
  <script src="/public/js/jquery-1.11.2.min.js"></script>
  <script src="/public/js/masonry.pkgd.min.js"></script>

  <!--[if lt IE 9]>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script>
    <script src="/public/js/rem.min.js"></script>
  <![endif]-->
</head>


  <body>

    <div class="wrap">
      <div class="master-nav">
        <div class="nav">
            <ul class="top-menu">
              <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
              <li><a href="/about.html"><i class="fa fa-info-circle"></i> About</a></li>
              <li><a href="/notes.html"><i class="fa fa-pencil"></i> Posts</a></li>
              <li><a class="resume" href="https://1modm.github.io/documentation/"><i class="fa fa-file-text-o"></i> Notes</a></li>
              <li><a class="special" href="https://github.com/1modm?tab=repositories"><i class="fa fa-github-alt"></i> Repositories</a></li>

            </ul>
        </div>
      </div>

      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
            <a href="/" title="Home">M</a>
            <small></small>
          </h2>

          <div class="footer-social-links">
  <a href="https://www.linkedin.com/in/mmorillo" title="LinkedIn" target="_blank"><i class="fa fa-linkedin"></i></a>
  <a href="https://twitter.com/1_mod_m" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>
  <a href="https://github.com/1modm" title="GitHub" target="_blank"><i class="fa fa-github-alt"></i></a>
</div>


        </div>
      </div>

      <div class="container content">
        <div class="post">
  <div class="post-top-meta">
    <div class="post-date">January 17, 2017 &middot; <span class="reading-time" title="Estimated Reading Time">
  
  
    12 minutes read
  
</span>
</div>
    <h1 class="post-title">Scapy</h1>
  </div>

  <div class="hrline"></div>

  <p><a href="http://www.secdev.org/projects/scapy/">Scapy</a> is a powerful interactive packet manipulation program. It is able to forge or decode packets of a wide number of protocols, send them on the wire, capture them, match requests and replies, and much more. It can easily handle most classical tasks like scanning, tracerouting, probing, unit tests, attacks or network discovery (it can replace hping, 85% of nmap, arpspoof, arp-sk, arping, tcpdump, tethereal, p0f, etc.). It also performs very well at a lot of other specific tasks that most other tools can’t handle, like sending invalid frames, injecting your own 802.11 frames, combining technics (VLAN hopping+ARP cache poisoning, VOIP decoding on WEP encrypted channel, …), etc.</p>

<h3 id="interactive-tutorial">Interactive tutorial</h3>
<p>See interactive tutorial and the quick demo: an interactive session: <a href="http://www.secdev.org/projects/scapy/doc/usage.html#interactive-tutorial">http://www.secdev.org/projects/scapy/doc/usage.html#interactive-tutorial</a></p>

<h3 id="command-line">Command line</h3>

<div class="highlighter-rouge"><pre class="highlight"><code># scapy 
Welcome to Scapy (2.2.0)
&gt;&gt;&gt; 

</code></pre>
</div>

<p>If we press twice Tab key we will see all the available functions</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; 
Display all 1299 possibilities? (y or n)
AES                                                IP6ListField                                       TFTP_Options
ARC2                                               IP6PrefixField                                     TFTP_RRQ
ARC4                                               IPField                                            TFTP_RRQ_server
ARP                                                IPID_count                                         TFTP_WRQ
ARPHDR_ETHER                                       IPOption                                           TFTP_WRQ_server
ARPHDR_LOOPBACK                                    IPOption_Address_Extension                         TFTP_operations
ARPHDR_METRICOM                                    IPOption_EOL                                       TFTP_read
ARPHDR_PPP                                         IPOption_LSRR                                      TFTP_write
ARPHDR_TUN                                         IPOption_MTU_Probe                                 TabError
ARPSourceMACField                                  IPOption_MTU_Reply                                 TimeStampField
ARP_am                                             IPOption_NOP                                       TracerouteResult
ARPingResult                                       IPOption_RR                                        TracerouteResult6
ASN1Codec                                          IPOption_Router_Alert                              True
ASN1F_BIT_STRING                                   IPOption_SDBM                                      TruncPktLenField
ASN1F_BOOLEAN                                      IPOption_SSRR                                      TypeError
ASN1F_CHOICE                                       IPOption_Security                                  UDP
ASN1F_ENUMERATED                                   IPOption_Stream_Id                                 UDP_SERVICES
ASN1F_GENERALIZED_TIME                             IPOption_Traceroute                                UDPerror
ASN1F_INTEGER                                      IPPROTO_SCTP                                       USER_CLASS_DATA
ASN1F_IPADDRESS                                    IPPROTO_VRRP                                       UTCTimeField
ASN1F_NULL                                         IPTools                                            UnboundLocalError
ASN1F_OID                                          IPV6_ADDR_6TO4                                     UnicodeDecodeError
ASN1F_PACKET                                       IPV6_ADDR_CAST_MASK                                UnicodeEncodeError
ASN1F_PRINTABLE_STRING                             IPV6_ADDR_GLOBAL                                   UnicodeError
ASN1F_SEP                                          IPV6_ADDR_LINKLOCAL                                UnicodeTranslateError
ASN1F_SEQUENCE                                     IPV6_ADDR_LOOPBACK                                 UnicodeWarning
ASN1F_SEQUENCE_OF                                  IPV6_ADDR_MULTICAST                                UserWarning
ASN1F_SET                                          IPV6_ADDR_SCOPE_MASK                               VENDOR_CLASS_DATA
ASN1F_SNMP_PDU_BULK                                IPV6_ADDR_SITELOCAL                                VENDOR_SPECIFIC_OPTION
ASN1F_SNMP_PDU_GET                                 IPV6_ADDR_UNICAST                                  VRRP
ASN1F_SNMP_PDU_INFORM                              IPV6_ADDR_UNSPECIFIED                              ValueError
ASN1F_SNMP_PDU_NEXT                                IP_PROTOS                                          VolatileValue
ASN1F_SNMP_PDU_RESPONSE                            IPerror                                            WINDOWS
ASN1F_SNMP_PDU_SET                                 IPerror6                                           Warning
ASN1F_SNMP_PDU_TRAPv1                              IPv6                                               WiFi_am
ASN1F_SNMP_PDU_TRAPv2                              IPv6ExtHdrDestOpt                                  X3BytesField
ASN1F_STRING                                       IPv6ExtHdrFragment                                 X509Cert
ASN1F_TIME_TICKS                                   IPv6ExtHdrHopByHop                                 X509RDN
ASN1F_UTC_TIME                                     IPv6ExtHdrRouting                                  X509v3Ext
ASN1F_X509_CONT0                                   IPv6inIP                                           X86_64
ASN1F_X509_CONT1                                   IRT_DEFAULT                                        XBitField
ASN1F_X509_CONT2                                   IRT_MINIMUM                                        XByteField
ASN1F_X509_CONT3                                   ISAKMP                                             XIntField
ASN1F_badsequence                                  ISAKMPAttributeTypes                               XLongField
ASN1F_element                                      ISAKMPTransformNum                                 XOR
ASN1F_enum_INTEGER                                 ISAKMPTransformSetField                            XShortEnumField
ASN1F_field                                        ISAKMPTransformTypes                               XShortField
ASN1F_optionnal                                    ISAKMP_class                                       ZeroDivisionError
ASN1Tag                                            ISAKMP_exchange_type                               ZuluTime
ASN1_BADTAG                                        ISAKMP_payload                                     __debug__
ASN1_BIT_STRING                                    ISAKMP_payload_Hash                                __doc__
ASN1_BOOLEAN                                       ISAKMP_payload_ID                                  __file__
ASN1_BadTag_Decoding_Error                         ISAKMP_payload_KE                                  __import__
ASN1_COUNTER32                                     ISAKMP_payload_Nonce                               __name__
ASN1_Class                                         ISAKMP_payload_Proposal                            __package__
ASN1_Class_SNMP                                    ISAKMP_payload_SA                                  abs
ASN1_Class_UNIVERSAL                               ISAKMP_payload_Transform                           addr
ASN1_Class_X509                                    ISAKMP_payload_VendorID                            airpwn
ASN1_Class_metaclass                               ISAKMP_payload_type                                all
ASN1_Codecs                                        ISAKMP_payload_type_overload                       any
ASN1_Codecs_metaclass                              ImportError                                        apply
ASN1_DECODING_ERROR                                ImportWarning                                      arch
ASN1_Decoding_Error                                IncrementalValue                                   arpcachepoison
ASN1_ENUMERATED                                    IndentationError                                   arping
ASN1_Encoding_Error                                IndexError                                         array
ASN1_Error                                         IntAutoTime                                        atol
ASN1_GAUGE32                                       IntEnumField                                       attach_filter
ASN1_GENERALIZED_TIME                              IntField                                           autorun_commands
ASN1_IA5_STRING                                    Interceptor                                        autorun_get_ansi_interactive_session
ASN1_INTEGER                                       IrLAPCommand                                       autorun_get_html_interactive_session
ASN1_IPADDRESS                                     IrLAPHead                                          autorun_get_interactive_session
ASN1_NULL                                          IrLMP                                              autorun_get_latex_interactive_session
ASN1_NUMERIC_STRING                                Jumbo                                              autorun_get_text_interactive_session
ASN1_OID                                           Key                                                base_classes
ASN1_Object                                        KeyError                                           basestring
ASN1_Object_metaclass                              KeyboardInterrupt                                  bastatus
ASN1_PRINTABLE_STRING                              KnowledgeBase                                      bin
ASN1_Packet                                        L2CAP_CmdHdr                                       bind_bottom_up
ASN1_SEP                                           L2CAP_CmdRej                                       bind_layers
ASN1_SEQUENCE                                      L2CAP_ConfReq                                      bind_top_down
ASN1_SET                                           L2CAP_ConfResp                                     bool
ASN1_SNMP_PDU_BULK                                 L2CAP_ConnReq                                      bootpd
ASN1_SNMP_PDU_GET                                  L2CAP_ConnResp                                     buffer
ASN1_SNMP_PDU_INFORM                               L2CAP_DisconnReq                                   bytearray
ASN1_SNMP_PDU_NEXT                                 L2CAP_DisconnResp                                  bytes
ASN1_SNMP_PDU_RESPONSE                             L2CAP_Hdr                                          cPickle
ASN1_SNMP_PDU_SET                                  L2CAP_InfoReq                                      callable
ASN1_SNMP_PDU_TRAPv1                               L2CAP_InfoResp                                     capability_list
ASN1_SNMP_PDU_TRAPv2                               L2ListenSocket                                     cert
ASN1_STRING                                        L2Socket                                           checksum
ASN1_T61_STRING                                    L2TP                                               chexdump
ASN1_TIME_TICKS                                    L3PacketSocket                                     chr
ASN1_UTC_TIME                                      L3RawSocket                                        classmethod
ASN1_VIDEOTEX_STRING                               L3RawSocket6                                       cmp
ASN1_X509_CONT0                                    LEFieldLenField                                    code
ASN1_X509_CONT1                                    LEIntEnumField                                     coerce
ASN1_X509_CONT2                                    LEIntField                                         colgen
ASN1_X509_CONT3                                    LELongField                                        compile
ASN1_force                                         LEShortEnumField                                   complex
AS_resolver                                        LEShortField                                       computeNIGroupAddr
AS_resolver6                                       LESignedIntField                                   conf
AS_resolver_cymru                                  LINUX                                              config
AS_resolver_multi                                  LLC                                                console_handler
AS_resolver_radb                                   LLMNRQuery                                         construct_source_candidate_set
AS_resolver_riswhois                               LLMNRResponse                                      copy
ATMT                                               LOOPBACK_NAME                                      copyright
ActionField                                        LatexTheme                                         corrupt_bits
All_DHCP_Relay_Agents_and_Servers                  LatexTheme2                                        corrupt_bytes
All_DHCP_Servers                                   LayersList                                         crc32
AnsiColorTheme                                     LenField                                           crc32c
AnsweringMachine                                   LifetimeField                                      crc32c_table
ArithmeticError                                    LogLevel                                           create_ca_file
AssertionError                                     LongField                                          create_styler
AttributeError                                     LookupError                                        create_temporary_ca_file
AutoTime                                           MACField                                           create_temporary_ca_path
Automaton                                          MANUFDB                                            credits
Automaton_metaclass                                MAX_CERT_SIZE                                      debug
BCDFloatField                                      MAX_CRL_SIZE                                       defaultdict
BER_BadTag_Decoding_Error                          MAX_KEY_SIZE                                       defrag
BER_Decoding_Error                                 MD2                                                defragment
BER_Encoding_Error                                 MD4                                                defragment6
BER_Exception                                      MD5                                                delattr
BER_len_dec                                        MGCP                                               deque
BER_len_enc                                        MIBDict                                            dhcp6_cls_by_type
BER_num_dec                                        MIP6MH_BA                                          dhcp6opts
BER_num_enc                                        MIP6MH_BE                                          dhcp6opts_by_code
BERcodec_BIT_STRING                                MIP6MH_BRR                                         dhcp6statuscodes
BERcodec_BOOLEAN                                   MIP6MH_BU                                          dhcp6types
BERcodec_COUNTER32                                 MIP6MH_CoT                                         dhcp_request
BERcodec_ENUMERATED                                MIP6MH_CoTI                                        dhcpd
BERcodec_GAUGE32                                   MIP6MH_Generic                                     dhcpmagic
BERcodec_GENERALIZED_TIME                          MIP6MH_HoT                                         dict
BERcodec_IA5_STRING                                MIP6MH_HoTI                                        dir
BERcodec_INTEGER                                   MIP6OptAltCoA                                      divmod
BERcodec_IPADDRESS                                 MIP6OptBRAdvice                                    dns_spoof
BERcodec_NULL                                      MIP6OptBindingAuthData                             dnsclasses
BERcodec_NUMERIC_STRING                            MIP6OptCGAParams                                   dnsqtypes
BERcodec_OID                                       MIP6OptCGAParamsReq                                dnsrepr2names
BERcodec_Object                                    MIP6OptCareOfTest                                  dnstypes
BERcodec_PRINTABLE_STRING                          MIP6OptCareOfTestInit                              do_graph
BERcodec_SEP                                       MIP6OptHomeKeygenToken                             duid_cls
BERcodec_SEQUENCE                                  MIP6OptLLAddr                                      duidhwtypes
BERcodec_SET                                       MIP6OptMNID                                        duidtypes
BERcodec_SNMP_PDU_BULK                             MIP6OptMobNetPrefix                                dyndns_add
BERcodec_SNMP_PDU_GET                              MIP6OptMsgAuth                                     dyndns_del
BERcodec_SNMP_PDU_INFORM                           MIP6OptNonceIndices                                enumerate
BERcodec_SNMP_PDU_NEXT                             MIP6OptReplayProtection                            error
BERcodec_SNMP_PDU_RESPONSE                         MIP6OptSignature                                   etherleak
BERcodec_SNMP_PDU_SET                              MIP6OptUnknown                                     eval
BERcodec_SNMP_PDU_TRAPv1                           MTU                                                execfile
BERcodec_SNMP_PDU_TRAPv2                           ManufDA                                            exit
BERcodec_STRING                                    MemoryError                                        export_object
BERcodec_T61_STRING                                Message                                            farpd
BERcodec_TIME_TICKS                                MobileIP                                           file
BERcodec_UTC_TIME                                  MobileIPRRP                                        filter
BERcodec_VIDEOTEX_STRING                           MobileIPRRQ                                        find_ifaddr2
BERcodec_X509_CONT0                                MobileIPTunnelData                                 fixname
BERcodec_X509_CONT1                                MultiEnumField                                     float
BERcodec_X509_CONT2                                NBNSNodeStatusResponse                             format
BERcodec_X509_CONT3                                NBNSNodeStatusResponseEnd                          fragleak
BERcodec_metaclass                                 NBNSNodeStatusResponseService                      fragleak2
BOOTP                                              NBNSQueryRequest                                   fragment
BOOTP_am                                           NBNSQueryResponse                                  fragment6
BaseException                                      NBNSQueryResponseNegative                          frozenset
BasePacket                                         NBNSRequest                                        fuzz
BasePacketList                                     NBNSWackResponse                                   generators
BitEnumField                                       NBTDatagram                                        get_cls
BitField                                           NBTSession                                         get_if
BitFieldLenField                                   NETBSD                                             get_if_addr
BitMultiEnumField                                  NIQueryCodeField                                   get_if_hwaddr
BlackAndWhite                                      NIQueryDataField                                   get_if_index
Blowfish                                           NIReplyDataField                                   get_if_list
BluetoothHCISocket                                 NTP                                                get_if_raw_addr
BluetoothL2CAPSocket                               NTPTimestampField                                  get_if_raw_addr6
BrightTheme                                        NameError                                          get_if_raw_hwaddr
BufferError                                        Neighbor                                           get_last_packet_timestamp
ByteEnumField                                      Net                                                get_source_addr_from_candidate_set
ByteField                                          Net6                                               get_temp_file
BytesWarning                                       NetBIOSNameField                                   get_toDS
CAST                                               NetBIOS_DS                                         get_working_if
CRL                                                NetCache                                           getattr
CacheInstance                                      NetflowHeader                                      getmacbyip
Cert                                               NetflowHeaderV1                                    getmacbyip6
CharEnumField                                      NetflowRecordV1                                    glob
ChunkParamField                                    NewDefaultValues                                   globals
Color                                              NoPayload                                          gw
ColorOnBlackTheme                                  NoTheme                                            gzip
ColorPrompt                                        NonceField                                         hasattr
ColorTheme                                         None                                               hash
CommandsList                                       NotImplemented                                     hashlib
ConditionalField                                   NotImplementedError                                help
Conf                                               Num2Layer                                          hex
ConfClass                                          OByteField                                         hexdiff
ConfigFieldList                                    OID                                                hexdump
CookedLinux                                        OPENBSD                                            hexedit
CorruptedBits                                      OSError                                            hexstr
CorruptedBytes                                     OSSLHelper                                         hmac
Crypto                                             ObjectPipe                                         iana_enterprise_num
DADict                                             OverflowError                                      icmp6_niqtypes
DADict_Exception                                   PACKET_ADD_MEMBERSHIP                              icmp6ndopts
DARWIN                                             PACKET_DROP_MEMBERSHIP                             icmp6ndoptscls
DEFAULT_PRESTART_FILE                              PACKET_MR_ALLMULTI                                 icmp6types
DEFAULT_STARTUP_FILE                               PACKET_MR_MULTICAST                                icmp6typescls
DES                                                PACKET_MR_PROMISC                                  icmpcodes
DES3                                               PACKET_RECV_OUTPUT                                 icmptypes
DHCP                                               PACKET_RX_RING                                     id
DHCP6                                              PACKET_STATISTICS                                  iff
DHCP6ClientIAID                                    PKCS1_OAEP                                         ikescan
DHCP6ClientIA_NA                                   PKCS1_v1_5                                         import_hexcap
DHCP6ClientIA_TA                                   PPI                                                import_object
DHCP6ClientUnicastAddr                             PPP                                                in6_6to4ExtractAddr
DHCP6CurrentTransactionID                          PPP_ECP                                            in6_addrtomac
DHCP6OptAuth                                       PPP_ECP_Option                                     in6_addrtovendor
DHCP6OptBCMCSDomains                               PPP_ECP_Option_OUI                                 in6_and
DHCP6OptBCMCSServers                               PPP_IPCP                                           in6_chksum
DHCP6OptClientFQDN                                 PPP_IPCP_Option                                    in6_cidr2mask
DHCP6OptClientId                                   PPP_IPCP_Option_DNS1                               in6_ctop
DHCP6OptDNSDomains                                 PPP_IPCP_Option_DNS2                               in6_get6to4Prefix
DHCP6OptDNSServers                                 PPP_IPCP_Option_IPAddress                          in6_getAddrType
DHCP6OptElapsedTime                                PPP_IPCP_Option_NBNS1                              in6_getLinkScopedMcastAddr
DHCP6OptGeoConf                                    PPP_IPCP_Option_NBNS2                              in6_getLocalUniquePrefix
DHCP6OptIAAddress                                  PPPoE                                              in6_getRandomizedIfaceId
DHCP6OptIAPrefix                                   PPPoED                                             in6_get_common_plen
DHCP6OptIA_NA                                      PYX                                                in6_getha
DHCP6OptIA_PD                                      Packet                                             in6_getifaddr
DHCP6OptIA_TA                                      PacketField                                        in6_getnsma
DHCP6OptIfaceId                                    PacketLenField                                     in6_getnsmac
DHCP6OptInfoRefreshTime                            PacketList                                         in6_getscope
DHCP6OptNISDomain                                  PacketListField                                    in6_ifaceidtomac
DHCP6OptNISPDomain                                 Packet_metaclass                                   in6_isaddr6to4
DHCP6OptNISPServers                                Pad1                                               in6_isaddrTeredo
DHCP6OptNISServers                                 PadField                                           in6_isaddrllallnodes
DHCP6OptOptReq                                     PadN                                               in6_isaddrllallservers
DHCP6OptPref                                       Padding                                            in6_isanycast
DHCP6OptRapidCommit                                PcapReader                                         in6_isdocaddr
DHCP6OptReconfAccept                               PcapWriter                                         in6_iseui64
DHCP6OptReconfMsg                                  PendingDeprecationWarning                          in6_isgladdr
DHCP6OptRelayAgentERO                              PrismHeader                                        in6_isincluded
DHCP6OptRelayMsg                                   ProgPath                                           in6_islladdr
DHCP6OptRemoteID                                   PseudoIPv6                                         in6_ismaddr
DHCP6OptSIPDomains                                 PubKey                                             in6_ismgladdr
DHCP6OptSIPServers                                 RDLenField                                         in6_ismlladdr
DHCP6OptSNTPServers                                RDataField                                         in6_ismnladdr
DHCP6OptServerId                                   RIP                                                in6_ismsladdr
DHCP6OptServerUnicast                              RIPAuth                                            in6_issladdr
DHCP6OptStatusCode                                 RIPEMD                                             in6_isuladdr
DHCP6OptSubscriberID                               RIPEntry                                           in6_mactoifaceid
DHCP6OptUnknown                                    RSA                                                in6_or
DHCP6OptUserClass                                  RTF_REJECT                                         in6_ptoc
DHCP6OptVendorClass                                RTF_UP                                             in6_ptop
DHCP6OptVendorSpecificInfo                         RTP                                                in6_xor
DHCP6PrefVal                                       RadioTap                                           incremental_label
DHCP6RelayAgentUnicastAddr                         Radius                                             inet_aton
DHCP6RelayHopCount                                 RandASN1Object                                     inet_ntoa
DHCP6ServerDUID                                    RandBin                                            inet_ntop
DHCP6ServerUnicastAddr                             RandByte                                           inet_pton
DHCP6_Advertise                                    RandChoice                                         input
DHCP6_Confirm                                      RandDHCPOptions                                    int
DHCP6_Decline                                      RandEnum                                           interact
DHCP6_InfoRequest                                  RandEnumByte                                       intern
DHCP6_Rebind                                       RandEnumInt                                        ioctl
DHCP6_Reconf                                       RandEnumLong                                       ipv6nh
DHCP6_RelayForward                                 RandEnumSByte                                      ipv6nhcls
DHCP6_RelayReply                                   RandEnumSInt                                       is_promisc
DHCP6_Release                                      RandEnumSLong                                      isinstance
DHCP6_Renew                                        RandEnumSShort                                     issubclass
DHCP6_Reply                                        RandEnumShort                                      iter
DHCP6_Request                                      RandField                                          itertools
DHCP6_Solicit                                      RandIP                                             itom
DHCPOptions                                        RandIP6                                            len
DHCPOptionsField                                   RandInt                                            lhex
DHCPRevOptions                                     RandLong                                           license
DHCPTypes                                          RandMAC                                            linehexdump
DHCP_am                                            RandNum                                            linux
DHCPv6_am                                          RandNumExpo                                        list
DNS                                                RandNumGamma                                       list_contrib
DNSQR                                              RandNumGauss                                       load_contrib
DNSQRField                                         RandOID                                            load_ethertypes
DNSRR                                              RandPool                                           load_layer
DNSRRCountField                                    RandRegExp                                         load_manuf
DNSRRField                                         RandSByte                                          load_mib
DNSStrField                                        RandSInt                                           load_module
DNS_am                                             RandSLong                                          load_object
DNSgetstr                                          RandSShort                                         load_protocols
DSA                                                RandShort                                          load_services
DUID_EN                                            RandSingByte                                       load_session
DUID_LL                                            RandSingInt                                        locals
DUID_LLT                                           RandSingLong                                       log
DefaultTheme                                       RandSingNum                                        log_interactive
DelayedEval                                        RandSingSByte                                      log_loading
DeprecationWarning                                 RandSingSInt                                       log_runtime
DestMACField                                       RandSingSLong                                      log_scapy
DomainNameField                                    RandSingSShort                                     logging
DomainNameListField                                RandSingShort                                      long
Dot11                                              RandSingString                                     ls
Dot11ATIM                                          RandSingularity                                    lsc
Dot11Addr2MACField                                 RandString                                         ltoa
Dot11Addr3MACField                                 RandTermString                                     mac2str
Dot11Addr4MACField                                 RandomEnumeration                                  make_lined_table
Dot11AddrMACField                                  RastaTheme                                         make_table
Dot11AssoReq                                       Raw                                                make_tex_table
Dot11AssoResp                                      RawPcapReader                                      map
Dot11Auth                                          RawPcapWriter                                      math
Dot11Beacon                                        RawVal                                             max
Dot11Deauth                                        ReferenceAM                                        memoryview
Dot11Disas                                         ReferenceError                                     mhtypes
Dot11Elt                                           Resolve                                            mib_register
Dot11PacketList                                    Route                                              min
Dot11ProbeReq                                      Route6                                             moboptcls
Dot11ProbeResp                                     RouterAlert                                        names2dnsrepr
Dot11QoS                                           RuntimeError                                       neighsol
Dot11ReassoReq                                     RuntimeWarning                                     new
Dot11ReassoResp                                    SCTP                                               next
Dot11SCField                                       SCTPChunkAbort                                     object
Dot11WEP                                           SCTPChunkCookieAck                                 oct
Dot1Q                                              SCTPChunkCookieEcho                                open
Dot3                                               SCTPChunkData                                      ord
EAP                                                SCTPChunkError                                     os
EAPOL                                              SCTPChunkHeartbeatAck                              overlap_frag
EOFError                                           SCTPChunkHeartbeatReq                              packet
ETHER_ANY                                          SCTPChunkInit                                      pkcs_emsa_pkcs1_v1_5_encode
ETHER_BROADCAST                                    SCTPChunkInitAck                                   pkcs_emsa_pss_encode
ETHER_TYPES                                        SCTPChunkParamAdaptationLayer                      pkcs_emsa_pss_verify
ETH_P_ALL                                          SCTPChunkParamCookiePreservative                   pkcs_i2osp
ETH_P_ARP                                          SCTPChunkParamECNCapable                           pkcs_mgf1
ETH_P_IP                                           SCTPChunkParamFwdTSN                               pkcs_os2ip
ETH_P_IPV6                                         SCTPChunkParamHearbeatInfo                         plist
ElGamal                                            SCTPChunkParamHostname                             plst
Ellipsis                                           SCTPChunkParamIPv4Addr                             popen2
Emph                                               SCTPChunkParamIPv6Addr                             pow
Emphasize                                          SCTPChunkParamStateCookie                          print
EnumElement                                        SCTPChunkParamSupportedAddrTypes                   print_chain
EnumField                                          SCTPChunkParamUnrocognizedParam                    promiscping
Enum_metaclass                                     SCTPChunkSACK                                      property
EnvironmentError                                   SCTPChunkShutdown                                  quit
Ether                                              SCTPChunkShutdownAck                               random
Exception                                          SCTPChunkShutdownComplete                          randstring
FREEBSD                                            SHA                                                range
False                                              SHA224                                             raw_input
Field                                              SHA256                                             rdpcap
FieldLenField                                      SHA384                                             re
FieldListField                                     SHA512                                             re_extract_hexcap
FixedPointField                                    SIOCGIFADDR                                        read_routes
FlagsField                                         SIOCGIFCONF                                        read_routes6
FloatingPointError                                 SIOCGIFCOUNT                                       reason_code
FormatTheme                                        SIOCGIFFLAGS                                       reduce
FutureWarning                                      SIOCGIFHWADDR                                      reload
GNUPLOT                                            SIOCGIFINDEX                                       report_ports
GPRS                                               SIOCGIFNAME                                        repr
GRE                                                SIOCGIFNETMASK                                     reversed
GRErouting                                         SIOCGSTAMP                                         round
GapAckField                                        SIOCSIFFLAGS                                       sane
Gen                                                SIOCSIFLINK                                        sane_color
GeneratorExit                                      SMBMailSlot                                        save_object
HAO                                                SMBNegociate_Protocol_Request_Header               save_session
HAS_HASHLIB                                        SMBNegociate_Protocol_Request_Tail                 scapy
HBHOptUnknown                                      SMBNegociate_Protocol_Response_Advanced_Security   scapy_delete_temp_files
HCI_ACL_Hdr                                        SMBNegociate_Protocol_Response_No_Security         scapy_session
HCI_Hdr                                            SMBNegociate_Protocol_Response_No_Security_No_Key  scapy_write_history_file
HDLC                                               SMBNetlogon_Protocol_Response_Header               sctpchunkparamtypes
HMAC                                               SMBNetlogon_Protocol_Response_Tail_LM20            sctpchunkparamtypescls
HSRP                                               SMBNetlogon_Protocol_Response_Tail_SAM             sctpchunktypes
HTMLTheme                                          SMBSession_Setup_AndX_Request                      sctpchunktypescls
HTMLTheme2                                         SMBSession_Setup_AndX_Response                     select
ICMP                                               SNAP                                               send
ICMPTimeStampField                                 SNMP                                               sendp
ICMPerror                                          SNMP_error                                         sendpfast
ICMPv6DestUnreach                                  SNMP_trap_types                                    sendrecv
ICMPv6EchoReply                                    SNMPbulk                                           session
ICMPv6EchoRequest                                  SNMPget                                            set
ICMPv6HAADReply                                    SNMPinform                                         set_promisc
ICMPv6HAADRequest                                  SNMPnext                                           setattr
ICMPv6MLDone                                       SNMPresponse                                       sha
ICMPv6MLQuery                                      SNMPset                                            skinny_messages
ICMPv6MLReport                                     SNMPtrapv1                                         slice
ICMPv6MPAdv                                        SNMPtrapv2                                         sndrcv
ICMPv6MPSol                                        SNMPvarbind                                        sndrcvflood
ICMPv6MRD_Advertisement                            SOLARIS                                            sniff
ICMPv6MRD_Solicitation                             SOL_PACKET                                         snmpwalk
ICMPv6MRD_Termination                              SOL_SOCKET                                         socket
ICMPv6NDOptAdvInterval                             SO_ATTACH_FILTER                                   sorted
ICMPv6NDOptDstLLAddr                               STP                                                split_bottom_up
ICMPv6NDOptEFA                                     ScapyAutorunInterpreter                            split_layers
ICMPv6NDOptHAInfo                                  ScapyFreqFilter                                    split_top_down
ICMPv6NDOptIPAddr                                  Scapy_Exception                                    sr
ICMPv6NDOptLLA                                     SebekHead                                          sr1
ICMPv6NDOptMAP                                     SebekV1                                            srbt
ICMPv6NDOptMTU                                     SebekV2                                            srbt1
ICMPv6NDOptNewRtrPrefix                            SebekV2Sock                                        srflood
ICMPv6NDOptPrefixInfo                              SebekV3                                            srloop
ICMPv6NDOptRDNSS                                   SebekV3Sock                                        srp
ICMPv6NDOptRedirectedHdr                           SetGen                                             srp1
ICMPv6NDOptRouteInfo                               ShortEnumField                                     srpflood
ICMPv6NDOptShortcutLimit                           ShortField                                         srploop
ICMPv6NDOptSrcAddrList                             SignedIntEnumField                                 staticmethod
ICMPv6NDOptSrcLLAddr                               SignedIntField                                     status_code
ICMPv6NDOptTgtAddrList                             SimpleSocket                                       str
ICMPv6NDOptUnknown                                 Skinny                                             str2mac
ICMPv6ND_INDAdv                                    SndRcvList                                         strand
ICMPv6ND_INDSol                                    SourceIP6Field                                     string
ICMPv6ND_NA                                        SourceIPField                                      struct
ICMPv6ND_NS                                        SourceMACField                                     strxor
ICMPv6ND_RA                                        StandardError                                      subprocess
ICMPv6ND_RS                                        StopAutorun                                        sum
ICMPv6ND_Redirect                                  StopIteration                                      super
ICMPv6NIQueryIPv4                                  StrField                                           sys
ICMPv6NIQueryIPv6                                  StrFixedLenEnumField                               tempfile
ICMPv6NIQueryNOOP                                  StrFixedLenField                                   teredoAddrExtractInfo
ICMPv6NIQueryName                                  StrLenField                                        tex_escape
ICMPv6NIReplyIPv4                                  StrNullField                                       themes
ICMPv6NIReplyIPv6                                  StrStopField                                       thread
ICMPv6NIReplyNOOP                                  StreamSocket                                       time
ICMPv6NIReplyName                                  SuperSocket                                        traceback
ICMPv6NIReplyRefuse                                SyntaxError                                        traceroute
ICMPv6NIReplyUnknown                               SyntaxWarning                                      traceroute6
ICMPv6PacketTooBig                                 SystemError                                        tshark
ICMPv6ParamProblem                                 SystemExit                                         tuple
ICMPv6TimeExceeded                                 T1                                                 type
ICMPv6Unknown                                      T2                                                 types
IEEEDoubleField                                    TCP                                                unichr
IEEEFloatField                                     TCPDUMP                                            unicode
IFF_BROADCAST                                      TCPOptions                                         update_session
IFF_DEBUG                                          TCPOptionsField                                    utils
IFF_LOOPBACK                                       TCP_SERVICES                                       vars
IFF_NOARP                                          TCP_client                                         warning
IFF_NOTRAILERS                                     TCPerror                                           warnings
IFF_POINTOPOINT                                    TFTP                                               wireshark
IFF_PROMISC                                        TFTP_ACK                                           with_statement
IFF_RUNNING                                        TFTP_DATA                                          wrpcap
IFF_UP                                             TFTP_ERROR                                         xrange
IOError                                            TFTP_Error_Codes                                   zerofree_randstring
IP                                                 TFTP_OACK                                          zip
IP6Field                                           TFTP_Option                                        zlib
&gt;&gt;&gt; 
</code></pre>
</div>

<h3 id="help">Help</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; ls()
ARP        : ARP
ASN1_Packet : None
BOOTP      : BOOTP
CookedLinux : cooked linux
DHCP       : DHCP options
DHCP6      : DHCPv6 Generic Message)
DHCP6OptAuth : DHCP6 Option - Authentication
...
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; lsc()
arpcachepoison      : Poison target's cache with (your MAC,victim's IP) couple
arping              : Send ARP who-has requests to determine which hosts are up
bind_layers         : Bind 2 layers on some specific fields' values
corrupt_bits        : Flip a given percentage or number of bits from a string
corrupt_bytes       : Corrupt a given percentage or number of bytes from a string
defrag              : defrag(plist) -&gt; ([not fragmented], [defragmented],
defragment          : defrag(plist) -&gt; plist defragmented as much as possible 
dyndns_add          : Send a DNS add message to a nameserver for "name" to have a new "rdata"
dyndns_del          : Send a DNS delete message to a nameserver for "name"
etherleak           : Exploit Etherleak flaw
fragment            : Fragment a big IP datagram
fuzz                : Transform a layer into a fuzzy layer by replacing some default values by random objects
getmacbyip          : Return MAC address corresponding to a given IP address
hexdiff             : Show differences between 2 binary strings
hexdump             : --
hexedit             : --
is_promisc          : Try to guess if target is in Promisc mode. The target is provided by its ip.
linehexdump         : --
ls                  : List  available layers, or infos on a given layer
promiscping         : Send ARP who-has requests to determine which hosts are in promiscuous mode
rdpcap              : Read a pcap file and return a packet list
send                : Send packets at layer 3
sendp               : Send packets at layer 2
sendpfast           : Send packets at layer 2 using tcpreplay for performance
sniff               : Sniff packets
split_layers        : Split 2 layers previously bound
sr                  : Send and receive packets at layer 3
sr1                 : Send packets at layer 3 and return only the first answer
srbt                : send and receive using a bluetooth socket
srbt1               : send and receive 1 packet using a bluetooth socket
srflood             : Flood and receive packets at layer 3
srloop              : Send a packet at layer 3 in loop and print the answer each time
srp                 : Send and receive packets at layer 2
srp1                : Send and receive packets at layer 2 and return only the first answer
srpflood            : Flood and receive packets at layer 2
srploop             : Send a packet at layer 2 in loop and print the answer each time
traceroute          : Instant TCP traceroute
tshark              : Sniff packets and print them calling pkt.show(), a bit like text wireshark
wireshark           : Run wireshark on a list of packets
wrpcap              : Write a list of packets to a pcap file
</code></pre>
</div>

<p>If it is needed to know the details for a certain function we can use help()</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; help(arpcachepoison)

Help on function arpcachepoison in module scapy.layers.l2:

arpcachepoison(target, victim, interval=60)
    Poison target's cache with (your MAC,victim's IP) couple
    arpcachepoison(target, victim, [interval=60]) -&gt; None
</code></pre>
</div>

<p><strong>Check layer fields</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; ls(UDP)
sport      : ShortEnumField       = (53)
dport      : ShortEnumField       = (53)
len        : ShortField           = (None)
chksum     : XShortField          = (None)
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; ls(IP)
version    : BitField             = (4)
ihl        : BitField             = (None)
tos        : XByteField           = (0)
len        : ShortField           = (None)
id         : ShortField           = (1)
flags      : FlagsField           = (0)
frag       : BitField             = (0)
ttl        : ByteField            = (64)
proto      : ByteEnumField        = (0)
chksum     : XShortField          = (None)
src        : Emph                 = (None)
dst        : Emph                 = ('127.0.0.1')
options    : PacketListField      = ([])
</code></pre>
</div>

<p><strong>Check layer params</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; udp=UDP()
&gt;&gt;&gt; udp.show()
###[ UDP ]###
  sport= domain
  dport= domain
  len= None
  chksum= None
&gt;&gt;&gt; udp.dport=5060
&gt;&gt;&gt; udp.show()
###[ UDP ]###
  sport= domain
  dport= sip
  len= None
  chksum= None
</code></pre>
</div>

<h3 id="packet-manipulation">Packet manipulation</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; packet=IP(dst="192.168.1.1-254")/ICMP()

&gt;&gt;&gt; packet.show()
###[ IP ]###
  version= 4
  ihl= None
  tos= 0x0
  len= None
  id= 1
  flags= 
  frag= 0
  ttl= 64
  proto= icmp
  chksum= None
  src= 192.168.1.12
  dst= Net('192.168.1.1-254')
  \options\
###[ ICMP ]###
     type= echo-request
     code= 0
     chksum= None
     id= 0x0
     seq= 0x0


&gt;&gt;&gt; send(packet)
..............................................................................................................................................................................................................................................................
Sent 254 packets.
&gt;&gt;&gt; 
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; send(IP(dst="192.168.1.1-254")/ICMP())
..............................................................................................................................................................................................................................................................
Sent 254 packets.
&gt;&gt;&gt; 
</code></pre>
</div>

<p><strong>difference between send() and sendp()</strong></p>

<p>send() function will send packets at layer 3. It will handle routing and layer 2 for you.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; send(IP(dst="192.168.1.1")/ICMP())
</code></pre>
</div>

<p>sendp() function will work at layer 2. Then can be used the right “or not” interface and the right “or not” link layer protocol.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; sendp(Ether()/IP(dst="192.168.1.1",ttl=(1,4)), iface="eth1")
</code></pre>
</div>

<p><strong>TCP/IP layers</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; IP()
&lt;IP  |&gt;
&gt;&gt;&gt; IP()/TCP()
&lt;IP  frag=0 proto=tcp |&lt;TCP  |&gt;&gt;
&gt;&gt;&gt; Ether()/IP()/TCP()
&lt;Ether  type=0x800 |&lt;IP  frag=0 proto=tcp |&lt;TCP  |&gt;&gt;&gt;
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt;&gt; packet=Ether()/IP(dst="www.cisco.com")/TCP(dport=80)/"GET / HTTP/1.1" 
&gt;&gt;&gt; sendp(packet)
.
Sent 1 packets.
</code></pre>
</div>

  
</div>
<div class="back"><a href="/notes.html"><i class="fa fa-chevron-left"></i> Back</a></div>

      </div>
    </div>

	  <div class="footer">
	<div class="hrline"></div>

	<div class="copyright">Made with <span style="color:#e00"><i class="fa fa-heart"></i></span> using <a href="http://jekyllrb.com">Jekyll</a> &middot; <i class="fa fa-code"></i> on <a href="https://github.com/heiswayi/heiswayi.github.io_jekyll_source">GitHub</a> <i class="fa fa-github-alt"></i><br>&copy; 2017 </div>
</div>

<script>
$(window).load(function() {
	$('.grid').masonry({
		itemSelector: '.grid-item',
		columnWidth: '.grid-sizer',
		gutter: 10
	});
});
</script>


	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-xxxx', 'auto');
  ga('send', 'pageview');
</script>




  </body>
</html>
