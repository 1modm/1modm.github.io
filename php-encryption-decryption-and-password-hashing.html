<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      PHP - Encryption, Decryption And Password Hashing &middot; Heiswayi Nrird on Tech
    
  </title>

  
    <meta name="description" content="Code snippets, examples of usage and the implementations."/>
    <meta name="keywords" content="php encryption, php decryption, password hashing using php">
  
  <meta name="author" content="Heiswayi Nrird">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@HeiswayiNrird">
  <meta name="twitter:creator" content="@HeiswayiNrird">
  
    <meta name="twitter:title" content="PHP - Encryption, Decryption And Password Hashing">
    <meta name="twitter:description" content="Code snippets, examples of usage and the implementations.">
  

  <meta property="og:type" content="website"/>
  
    <meta property="og:title" content="PHP - Encryption, Decryption And Password Hashing"/>
    <meta property="og:url" content="/php-encryption-decryption-and-password-hashing.html"/>
    <meta property="og:description" content="Code snippets, examples of usage and the implementations."/>
    <meta property="og:site_name" content="PHP - Encryption, Decryption And Password Hashing"/>
  

  <link rel="apple-touch-icon" sizes="57x57" href="/public/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/public/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/public/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/public/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/public/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/public/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/public/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/public/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/public/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/public/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/public/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/public/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/public/icons/favicon-16x16.png">
  <link rel="manifest" href="/public/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#f3f3f3">
  <meta name="msapplication-TileImage" content="/public/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="aSavCGGU0uSN5HEHnI7ZiMqVKxn7mfUPCGMVJvmDQ1w" />
  <meta name="wot-verification" content="6da2597a332a1fadad8f"/>

  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/public/css/normalize.css">
  <link rel="stylesheet" href="/public/css/style.css">

  <script src="/public/js/modernizr.custom.js"></script>
  <script src="/public/js/jquery-1.11.2.min.js"></script>
  <script src="/public/js/masonry.pkgd.min.js"></script>

  <!--[if lt IE 9]>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script>
    <script src="/public/js/rem.min.js"></script>
  <![endif]-->
</head>


  <body>

    <div class="wrap">
      <div class="master-nav">
        <div class="nav">
            <ul class="top-menu">
              <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
              <li><a href="/about.html"><i class="fa fa-info-circle"></i> About</a></li>
              <li><a href="/notes.html"><i class="fa fa-pencil"></i> Notes</a></li>
              <li><a class="resume" href="http://heiswayi.github.io/resume/"><i class="fa fa-file-text-o"></i> Resume</a></li>
              <li><a class="special" href="http://heiswayi.github.io/my-repos/"><i class="fa fa-github-alt"></i> Repositories</a></li>
              <li><a class="special" href="http://heiswayi.github.io/my-gists/"><i class="fa fa-code"></i> Gists</a></li>
              <li><a class="unique" href="http://heiswayi.nrird.com"><i class="fa fa-camera-retro"></i> Photography</a></li>
            </ul>
        </div>
      </div>

      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
            <a href="/" title="Home">Heiswayi Nrird on Tech</a>
            <small>Another Software Guy's Blog</small>
          </h2>

          <div class="footer-social-links">
  <a href="http://heiswayi.nrird.com/atom.xml" title="RSS Feed" target="_blank"><i class="fa fa-rss"></i></a>
  <a href="https://my.linkedin.com/in/nrird" title="LinkedIn" target="_blank"><i class="fa fa-linkedin"></i></a>
  <a href="https://www.facebook.com/profile.php?id=1257583160" title="Facebook" target="_blank"><i class="fa fa-facebook"></i></a>
  <a href="https://twitter.com/HeiswayiNrird" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>
  <a href="https://github.com/heiswayi" title="GitHub" target="_blank"><i class="fa fa-github-alt"></i></a>
  <a href="https://gist.github.com/heiswayi" title="GitHub Gist" target="_blank"><i class="fa fa-code"></i></a>
  <a href="http://codepen.io/heiswayi/" title="CodePen" target="_blank"><i class="fa fa-codepen"></i></a>
  <a href="https://500px.com/heiswayi_nrird" title="500px" target="_blank"><i class="fa fa-500px"></i></a>
  <a href="https://instagram.com/heiswayi.nrird/" title="Instagram" target="_blank"><i class="fa fa-instagram"></i></a>
</div>


        </div>
      </div>

      <div class="container content">
        <div class="post">
  <div class="post-top-meta">
    <div class="post-date">August 17, 2015 &middot; <span class="reading-time" title="Estimated Reading Time">
  
  
    4 minutes read
  
</span>
</div>
    <h1 class="post-title">PHP - Encryption, Decryption And Password Hashing</h1>
  </div>

  <div class="hrline"></div>

  <p>These days, people are browsing the web a lot. Some of them may be doing their business at risk when they are using a web application that is weakly built in protecting its user’s data or confidential information. It doesn’t matter how simple or complicated, small or big the application is, when it involves keeping the user’s data, we (the developers) need to take care their information well and ensure their data are safe with our application. One way to do that is by encrypting the data before we save it.</p>

<p>In PHP, there are many methods that we can encrypt the information. These code snippets are ones that I commonly used in my application to ensure their confidential information are not easily been disclosed.</p>

<h3 id="encryption">Encryption</h3>

<p>This is a PHP function used to encrypt the data string.</p>

<div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">Encrypt</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$data</span><span class="p">)</span>
<span class="p">{</span>

    <span class="nv">$salt</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nb">mt_rand</span><span class="p">(),</span> <span class="kc">true</span><span class="p">),</span> <span class="mi">8</span><span class="p">);</span>

    <span class="nv">$key</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span> <span class="o">.</span> <span class="nv">$salt</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nv">$iv</span>  <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$key</span> <span class="o">.</span> <span class="nv">$password</span> <span class="o">.</span> <span class="nv">$salt</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

    <span class="nv">$ct</span> <span class="o">=</span> <span class="nb">mcrypt_encrypt</span><span class="p">(</span><span class="nx">MCRYPT_RIJNDAEL_128</span><span class="p">,</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$data</span><span class="p">,</span> <span class="nx">MCRYPT_MODE_CBC</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">);</span>

    <span class="k">return</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="s1">'Salted__'</span> <span class="o">.</span> <span class="nv">$salt</span> <span class="o">.</span> <span class="nv">$ct</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
</div>

<h4 id="example-of-usage">Example of Usage</h4>

<div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nx">Encrypt</span><span class="p">(</span><span class="s1">'myPass123'</span><span class="p">,</span> <span class="s1">'Welcome to Flippancy 25'</span><span class="p">);</span>
<span class="c1">// Output: U2FsdGVkX19LYv5Y5EDmFbjH8bGMDFwlid30h2x1ybibT1Dwp0vekJ0OT4tb7/j6
</span><span class="cp">?&gt;</span>
</code></pre>
</div>

<p>The special feature here is, every time I execute this function <code class="highlighter-rouge">Encrypt()</code>, by using the <strong>same</strong> password and <strong>same</strong> data, the encrypted string is always changed.</p>

<p>Here is the output examples of encrypted strings after I executed it for three times:-</p>

<div class="highlighter-rouge"><pre class="highlight"><code>// Output 1: U2FsdGVkX19LYv5Y5EDmFbjH8bGMDFwlid30h2x1ybibT1Dwp0vekJ0OT4tb7/j6
// Output 2: U2FsdGVkX1/3zxJCcE8p89t67nJNp8blNkezNxTVn4IDFQLM755K2+OSfFHewDLI
// Output 3: U2FsdGVkX18OQ8puUN8BBi+d6vAjEzDTZqM2WaKQD1atOykkYl9MY7NQM1DqI4Kw
</code></pre>
</div>

<p>Hence, even the encrypted strings are changed each time I executed the function for the same input data, but these three encrypted strings are still can be decrypted and output the <strong>same</strong> results. This is the uniqueness of this encryption function.</p>

<h3 id="decryption">Decryption</h3>

<p>To get back the original data string, we need the decryption function.</p>

<div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">Decrypt</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$data</span><span class="p">)</span>
<span class="p">{</span>

    <span class="nv">$data</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
    <span class="nv">$salt</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
    <span class="nv">$ct</span>   <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>

    <span class="nv">$key</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span> <span class="o">.</span> <span class="nv">$salt</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="nv">$iv</span>  <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$key</span> <span class="o">.</span> <span class="nv">$password</span> <span class="o">.</span> <span class="nv">$salt</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

    <span class="nv">$pt</span> <span class="o">=</span> <span class="nb">mcrypt_decrypt</span><span class="p">(</span><span class="nx">MCRYPT_RIJNDAEL_128</span><span class="p">,</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$ct</span><span class="p">,</span> <span class="nx">MCRYPT_MODE_CBC</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$pt</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
</div>

<h4 id="example-of-usage-1">Example of Usage</h4>

<div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nx">Decrypt</span><span class="p">(</span><span class="s1">'myPass123'</span><span class="p">,</span> <span class="s1">'U2FsdGVkX19LYv5Y5EDmFbjH8bGMDFwlid30h2x1ybibT1Dwp0vekJ0OT4tb7/j6'</span><span class="p">);</span>
<span class="k">echo</span> <span class="nx">Decrypt</span><span class="p">(</span><span class="s1">'myPass123'</span><span class="p">,</span> <span class="s1">'U2FsdGVkX1/3zxJCcE8p89t67nJNp8blNkezNxTVn4IDFQLM755K2+OSfFHewDLI'</span><span class="p">);</span>
<span class="k">echo</span> <span class="nx">Decrypt</span><span class="p">(</span><span class="s1">'myPass123'</span><span class="p">,</span> <span class="s1">'U2FsdGVkX18OQ8puUN8BBi+d6vAjEzDTZqM2WaKQD1atOykkYl9MY7NQM1DqI4Kw'</span><span class="p">);</span>
<span class="c1">// All of three above will output the same decrypted data: Welcome to Flippancy 25
</span><span class="cp">?&gt;</span>
</code></pre>
</div>

<p>As you can see, for each encryption and decryption, the correct password/passcode is required in order to get back the original data strings.</p>

<h3 id="application-of-data-encryption-and-decryption">Application of Data Encryption and Decryption</h3>

<p>These both PHP encryption and decryption functions are useful when we want to securely encrypt user’s confidential information such as Social Security number, Phone number, Bank Account number, Credit Card information, whatnot and at some points of time, we need it back in plain text or the original version of the data.</p>

<blockquote>
  <p>Using these functions for saving passwords are NOT RECOMMENDED as it is reversible (ability to be decrypted). Check the next topic!</p>
</blockquote>

<h3 id="password-hashing">Password Hashing</h3>

<p>Despite encryption and decryption of the data, another part that plays important role in our application development is password hashing. The best implementation in password hashing is to use <strong><em>one-way</em></strong> hashing technique. Meaning that, it is irreversible. Unlikely the encryptions, they are formulated to be able to be decrypted it back. The password is encrypted and hashed for one-time only and it is no longer can be decrypted to a plain text anymore. You may want to check <a href="http://php.net/manual/en/function.password-hash.php">password_hash</a> or <a href="http://php.net/manual/en/function.crypt.php">crypt</a> for PHP one-way hashing algorithms.</p>

<p>In my projects, I usually use this hashing function to hash the user’s password:</p>

<div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="nf">hashPassword</span><span class="p">(</span><span class="nv">$password</span><span class="p">,</span> <span class="nv">$salt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$hash_password</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="s2">"SHA512"</span><span class="p">,</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">str_rot13</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="s2">"SHA512"</span><span class="p">,</span> <span class="nb">str_rot13</span><span class="p">(</span><span class="nv">$salt</span> <span class="o">.</span> <span class="nv">$password</span><span class="p">)))));</span>
    <span class="k">return</span> <span class="nv">$hash_password</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
</div>

<h4 id="example-of-usage-2">Example of Usage</h4>

<div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nx">hashPassword</span><span class="p">(</span><span class="s1">'myPa55w0rd'</span><span class="p">,</span> <span class="s1">'Flipp@ncy25'</span><span class="p">);</span>
<span class="c1">// Output: 815890bb72e10a75a52087513a931afb6641a5d8d105365fa6f389f038dd81b45290a44cf94bb61e7741e073c6f4d59a16e9896bd197cc320f84f3a4d27cfb50
</span><span class="cp">?&gt;</span>
</code></pre>
</div>

<hr />

<p>For more details about password hashing, I <strong>recommended</strong> you to read <a href="https://crackstation.net/hashing-security.htm">this article</a>. It’s a really good article about salted password hashing.</p>

  
</div>
<div class="back"><a href="/notes.html"><i class="fa fa-chevron-left"></i> Back</a></div>

      </div>
    </div>

	  <div class="footer">
	<div class="hrline"></div>
	<div class="license">Unless otherwise stated, all original code presented on this site is licensed under the <a href="http://heiswayi.github.io/mit-license">MIT license</a>. All original photographs and text on this website are licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives</a> license. If you have any questions about using any of this material for commercial purposes, please <a href="https://github.com/heiswayi/ama">ask me here</a> or <a href="mailto:asd@gmail.com">write an email to me</a>.</div>
	<div class="copyright">Made with <span style="color:#e00"><i class="fa fa-heart"></i></span> using <a href="http://jekyllrb.com">Jekyll</a> &middot; <i class="fa fa-code"></i> on <a href="https://github.com/heiswayi/heiswayi.github.io_jekyll_source">GitHub</a> <i class="fa fa-github-alt"></i><br>&copy; 2016 Heiswayi Nrird</div>
</div>

<script>
$(window).load(function() {
	$('.grid').masonry({
		itemSelector: '.grid-item',
		columnWidth: '.grid-sizer',
		gutter: 10
	});
});
</script>


	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-58296043-7', 'auto');
  ga('send', 'pageview');
</script>




  </body>
</html>
