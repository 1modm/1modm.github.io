<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      DefectDojo &middot; M
    
  </title>

  
    <meta name="description" content="DefectDojo API usage example"/>
    <meta name="keywords" content="DefectDojo API security">
  
  <meta name="author" content="Heiswayi Nrird">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@1_mod_m">
  <meta name="twitter:creator" content="@1_mod_m">
  
    <meta name="twitter:title" content="DefectDojo">
    <meta name="twitter:description" content="DefectDojo API usage example">
  

  <meta property="og:type" content="website"/>
  
    <meta property="og:title" content="DefectDojo"/>
    <meta property="og:url" content="https://1modm.github.io/DefectDojo.html"/>
    <meta property="og:description" content="DefectDojo API usage example"/>
    <meta property="og:site_name" content="DefectDojo"/>
  

  <link rel="apple-touch-icon" sizes="57x57" href="https://1modm.github.io/public/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="https://1modm.github.io/public/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="https://1modm.github.io/public/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="https://1modm.github.io/public/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://1modm.github.io/public/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://1modm.github.io/public/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="https://1modm.github.io/public/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://1modm.github.io/public/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://1modm.github.io/public/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="https://1modm.github.io/public/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://1modm.github.io/public/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="https://1modm.github.io/public/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://1modm.github.io/public/icons/favicon-16x16.png">
  <link rel="manifest" href="https://1modm.github.io/public/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#f3f3f3">
  <meta name="msapplication-TileImage" content="https://1modm.github.io/public/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="aSavCGGU0uSN5HEHnI7ZiMqVKxn7mfUPCGMVJvmDQ1w" />
  <meta name="wot-verification" content="6da2597a332a1fadad8f"/>

  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://1modm.github.io/atom.xml">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://1modm.github.io/public/css/normalize.css">
  <link rel="stylesheet" href="https://1modm.github.io/public/css/style.css">

  <script src="https://1modm.github.io/public/js/modernizr.custom.js"></script>
  <script src="https://1modm.github.io/public/js/jquery-1.11.2.min.js"></script>
  <script src="https://1modm.github.io/public/js/masonry.pkgd.min.js"></script>

  <!--[if lt IE 9]>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script>
    <script src="https://1modm.github.io/public/js/rem.min.js"></script>
  <![endif]-->
</head>


  <body>

    <div class="wrap">
      <div class="master-nav">
        <div class="nav">
            <ul class="top-menu">
              <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
              <li><a href="/about.html"><i class="fa fa-info-circle"></i> About</a></li>
              <li><a href="/notes.html"><i class="fa fa-pencil"></i> Posts</a></li>
              <li><a class="resume" href="https://1modm.github.io/documentation/"><i class="fa fa-file-text-o"></i> Notes</a></li>
              <li><a class="special" href="https://github.com/1modm?tab=repositories"><i class="fa fa-github-alt"></i> Repositories</a></li>

            </ul>
        </div>
      </div>

      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
            <a href="/" title="Home">M</a>
            <small></small>
          </h2>

          <div class="footer-social-links">
  <a href="https://www.linkedin.com/in/mmorillo" title="LinkedIn" target="_blank"><i class="fa fa-linkedin"></i></a>
  <a href="https://twitter.com/1_mod_m" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>
  <a href="https://github.com/1modm" title="GitHub" target="_blank"><i class="fa fa-github-alt"></i></a>
</div>


        </div>
      </div>

      <div class="container content">
        <div class="post">
  <div class="post-top-meta">
    <div class="post-date">December 15, 2018 &middot; <span class="reading-time" title="Estimated Reading Time">
  
  
    2 minutes read
  
</span>
</div>
    <h1 class="post-title">DefectDojo</h1>
  </div>

  <div class="hrline"></div>

  <p><a href="https://github.com/DefectDojo/django-DefectDojo"><strong>DefectDojo</strong></a> is a security program and vulnerability management tool. DefectDojo allows you to manage your application security program, maintain product and application information, schedule scans, triage vulnerabilities and push findings into defect trackers. Consolidate your findings into one source of truth with DefectDojo.</p>

<p><img src="https://raw.githubusercontent.com/DefectDojo/Documentation/master/doc/img/screenshot1.png" alt="Screenshot" /></p>

<p>It is very easy to install and start to use:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git clone https://github.com/DefectDojo/django-DefectDojo
$ cd django-DefectDojo
$ ./setup.bash
$ ./run_dojo.bash
</code></pre></div></div>

<p>For detailed documentation you can visit <a href="https://defectdojo.readthedocs.io/en/latest/"><strong>Read the Docs</strong></a>.</p>

<p>One of the most powerful features is the complete Swagger API. In previous releases the API was created using Tastypie, available within each DefectDojo installation at /api/v1/doc/</p>

<p>But now the API is created using Swagger for django, available within each DefectDojo installation at /api/v2/doc/</p>

<p>Using a Token provided for each DefectDojo user and installation can be easily manage this Vulnerability Management Tool. The next examples can used as starting point in order to create our own integration tool, below you can see how to get all the products in our installation and how to upload reports for all the security tools and scanners integrated in DefectDojo.</p>

<h3 id="examples">Examples</h3>

<p>In the next def is sent the data as HTTP GET or HTTP POST depending on the operation needed to be executed:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def fetch_data(DefectDojoURL, headersapi, dataApi, upload):

    if dataApi or upload:
        r = requests.post(DefectDojoURL, headers = headersapi, data = dataApi, verify=False)
    else:
        r = requests.get(DefectDojoURL, headers = headersapi, verify=False)

    if not (r.status_code == 200 or r.status_code == 201):
        logging.error('Error in operation')
        return False

    results = json.loads(r.text)
   
    if results:
        try:
            return results['results']
        except KeyError as error:
            return results
    else:
        logging.error('Error in operation')
        return None
</code></pre></div></div>

<p>The next def is an example in which can be retrieved all the products in our DefectDojo:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def GetProducts(DefectDojoURL, apiKey):

    url = DefectDojoURL + "/api/v2/products/"
    dataApi = None
    headers = {'Authorization':apiKey}
    data = []
    n = 0

    jsondata = fetch_data(url, headers, dataApi, false)

    if jsondata:
        for results in jsondata:
            n += 1
            product_url = results['url'].split("/")
            id_product = product_url[len(product_url)-2]

            data.append([n, id_product, results['name'], results['url'], results['findings_count'], results['prod_type'], results['description'], results['platform'], results['lifecycle'], results['origin']])

        print((colored(tabulate(data, tablefmt="fancy_grid", headers=["#", "ID Product", "Name", "URL", "Findings", "Product Type", "Description", "Platform", "Lifecycle", "Origin"]), 'green')))
</code></pre></div></div>

<p>The next def is an example in which can be upladed report scans for the tools integrated in DefectDojo:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def UploadScan(DefectDojoURL, apiKey, engegementID, PathFile, scan_type, scan_date):

    url = DefectDojoURL + "/api/v2/import-scan/"

    headers = {'Authorization':apiKey}
    data = []
    n = 0

    engagement_id = '/api/v2/engagements/' + engegementID + '/'
    active = 'true'
    tags = 'test'
    build = 'test'
    minimum_severity = 'Info'
    lead = 'http://X.X.X.X:8888/api/v2/users/1/?id=1'

    dataV2 = {
      'engagement': ('', engagement_id),
      'verified': ('', active),
      'lead': ('', lead),
      'tags': ('', tags),
      'scan_date': ('', scan_date),
      'scan_type': ('', scan_type),
      'minimum_severity': ('', minimum_severity),
      'file': open(PathFile, 'rb'),
      'active': ('', active)
    }

    jsondata = fetch_data(url, headers, dataV2, true)

    if jsondata:
        n += 1
        data.append([n, jsondata['active'], jsondata['engagement'], jsondata['lead'], jsondata['minimum_severity'], jsondata['scan_date'], jsondata['scan_type'], jsondata['verified']])

        print((colored(tabulate(data, tablefmt="fancy_grid", headers=["#", "Active", "Engagement", "Lead", "Minimum severity", "Scan Date", "Scan Type", "Verified"]), 'green')))

</code></pre></div></div>

  
</div>
<div class="back"><a href="/notes.html"><i class="fa fa-chevron-left"></i> Back</a></div>

      </div>
    </div>

	  <div class="footer">
	<div class="hrline"></div>

	<div class="copyright">Made with <span style="color:#e00"><i class="fa fa-heart"></i></span> using <a href="http://jekyllrb.com">Jekyll</a> &middot; <i class="fa fa-code"></i> on <a href="https://github.com/heiswayi/heiswayi.github.io_jekyll_source">GitHub</a> <i class="fa fa-github-alt"></i><br>&copy; 2018 </div>
</div>

<script>
$(window).load(function() {
	$('.grid').masonry({
		itemSelector: '.grid-item',
		columnWidth: '.grid-sizer',
		gutter: 10
	});
});
</script>


	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-xxxx', 'auto');
  ga('send', 'pageview');
</script>




  </body>
</html>
