<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Creating WPF Cascaded ComboBox In MVVM &middot; Heiswayi Nrird on Tech
    
  </title>

  
    <meta name="description" content="A tutorial to create an example of WPF cascaded ComboBox using MVVM design pattern."/>
    <meta name="keywords" content="cascaded combobox, wpf mvvm">
  
  <meta name="author" content="Heiswayi Nrird">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@HeiswayiNrird">
  <meta name="twitter:creator" content="@HeiswayiNrird">
  
    <meta name="twitter:title" content="Creating WPF Cascaded ComboBox In MVVM">
    <meta name="twitter:description" content="A tutorial to create an example of WPF cascaded ComboBox using MVVM design pattern.">
  

  <meta property="og:type" content="website"/>
  
    <meta property="og:title" content="Creating WPF Cascaded ComboBox In MVVM"/>
    <meta property="og:url" content="/creating-wpf-cascaded-combobox-in-mvvm.html"/>
    <meta property="og:description" content="A tutorial to create an example of WPF cascaded ComboBox using MVVM design pattern."/>
    <meta property="og:site_name" content="Creating WPF Cascaded ComboBox In MVVM"/>
  

  <link rel="apple-touch-icon" sizes="57x57" href="/public/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/public/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/public/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/public/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/public/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/public/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/public/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/public/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/public/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/public/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/public/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/public/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/public/icons/favicon-16x16.png">
  <link rel="manifest" href="/public/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#f3f3f3">
  <meta name="msapplication-TileImage" content="/public/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="aSavCGGU0uSN5HEHnI7ZiMqVKxn7mfUPCGMVJvmDQ1w" />
  <meta name="wot-verification" content="6da2597a332a1fadad8f"/>

  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/public/css/normalize.css">
  <link rel="stylesheet" href="/public/css/style.css">

  <script src="/public/js/modernizr.custom.js"></script>
  <script src="/public/js/jquery-1.11.2.min.js"></script>
  <script src="/public/js/masonry.pkgd.min.js"></script>

  <!--[if lt IE 9]>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script>
    <script src="/public/js/rem.min.js"></script>
  <![endif]-->
</head>


  <body>

    <div class="wrap">
      <div class="master-nav">
        <div class="nav">
            <ul class="top-menu">
              <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
              <li><a href="/about.html"><i class="fa fa-info-circle"></i> About</a></li>
              <li><a href="/notes.html"><i class="fa fa-pencil"></i> Notes</a></li>
              <li><a class="resume" href="http://heiswayi.github.io/resume/"><i class="fa fa-file-text-o"></i> Resume</a></li>
              <li><a class="special" href="http://heiswayi.github.io/my-repos/"><i class="fa fa-github-alt"></i> Repositories</a></li>
              <li><a class="special" href="http://heiswayi.github.io/my-gists/"><i class="fa fa-code"></i> Gists</a></li>
              <li><a class="unique" href="http://heiswayi.nrird.com"><i class="fa fa-camera-retro"></i> Photography</a></li>
            </ul>
        </div>
      </div>

      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
            <a href="/" title="Home">Heiswayi Nrird on Tech</a>
            <small>Another Software Guy's Blog</small>
          </h2>

          <div class="footer-social-links">
  <a href="http://heiswayi.nrird.com/atom.xml" title="RSS Feed" target="_blank"><i class="fa fa-rss"></i></a>
  <a href="https://my.linkedin.com/in/nrird" title="LinkedIn" target="_blank"><i class="fa fa-linkedin"></i></a>
  <a href="https://www.facebook.com/profile.php?id=1257583160" title="Facebook" target="_blank"><i class="fa fa-facebook"></i></a>
  <a href="https://twitter.com/HeiswayiNrird" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>
  <a href="https://github.com/heiswayi" title="GitHub" target="_blank"><i class="fa fa-github-alt"></i></a>
  <a href="https://gist.github.com/heiswayi" title="GitHub Gist" target="_blank"><i class="fa fa-code"></i></a>
  <a href="http://codepen.io/heiswayi/" title="CodePen" target="_blank"><i class="fa fa-codepen"></i></a>
  <a href="https://500px.com/heiswayi_nrird" title="500px" target="_blank"><i class="fa fa-500px"></i></a>
  <a href="https://instagram.com/heiswayi.nrird/" title="Instagram" target="_blank"><i class="fa fa-instagram"></i></a>
</div>


        </div>
      </div>

      <div class="container content">
        <div class="post">
  <div class="post-top-meta">
    <div class="post-date">November 19, 2015 &middot; <span class="reading-time" title="Estimated Reading Time">
  
  
    20 minutes read
  
</span>
</div>
    <h1 class="post-title">Creating WPF Cascaded ComboBox In MVVM</h1>
  </div>

  <div class="hrline"></div>

  <p>Implementing ComboBox in WPF XAML with MVVM design pattern may look like hard at first, but not that hard actually. This tutorial will show you a basic example how you can develop the <strong>cascaded ComboBox with MVVM implementation</strong> using <code class="highlighter-rouge">List&lt;T&gt;</code> class.</p>

<h2 id="understanding-mvvm">Understanding MVVM</h2>

<p>First, we need to understand how MVVM pattern works. Let’s see the MVVM architecture below:</p>

<p><img src="http://i.imgur.com/kLUzCAs.gif" alt="MVVM" /></p>

<p><em>Example diagram of MVVM design pattern.</em></p>

<p>Here are the basic explanations of MVVM important elements:-</p>

<ul>
  <li><strong>View:</strong> This is our UI design, in this case is our XAML. The view is responsible for defining the structure, layout, and appearance of what the user sees on the screen. No business logic is here.</li>
  <li><strong>Model:</strong> This is a data model along with business and validation logic.</li>
  <li><strong>ViewModel:</strong> This is what we called the glue that binds <strong>View</strong> and <strong>Model</strong> together. It’s responsible for handling the view logic. Typically, the view model interacts with the model by invoking methods in the model classes. The view model then provides data from the model in a form that the view can easily use. The view model retrieves data from the model and then makes the data available to the view, and may reformat the data in some way that makes it simpler for the view to handle. The view model also provides implementations of commands that a user of the application initiates in the view.</li>
</ul>

<h2 id="getting-started">Getting Started</h2>

<p>So, to do this in Visual Studio, let’s start with a new project. In my case, here is how my Visual Studio project structure looks:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Solution 'ComboBoxMVVMExample' (1 project)
└── ComboBoxMVVMExample
	├── Properties
	├── References
	├── Model
	├── View
	├── ViewModel
	├── App.config
	├── App.xaml
	└── MainWindow.xaml
</code></pre>
</div>

<p>Don’t forget to create these three folders; <strong>Model</strong>, <strong>View</strong> and <strong>ViewModel</strong>. These folders are not automatically generated by Visual Studio, we need to create them ourselves.</p>

<p>Inside <strong>ViewModel</strong>, let’s create two common class files called <code class="highlighter-rouge">RelayCommand.cs</code> and <code class="highlighter-rouge">ViewModelBase.cs</code>. So, our new project structure should look like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Solution 'ComboBoxMVVMExample' (1 project)
└── ComboBoxMVVMExample
	├── Properties
	├── References
	├── Model
	├── View
	├── ViewModel
	|	├── RelayCommand.cs
	|	└── ViewModelBase.cs
	├── App.config
	├── App.xaml
	└── MainWindow.xaml
</code></pre>
</div>

<p><strong>NOTE:</strong> All code here have been simplified; all comments and linebreaks have been removed. Please check the <a href="https://github.com/heiswayi/ComboBoxMVVMExample">source code</a> of the project for more details.</p>

<p>The code inside <code class="highlighter-rouge">ViewModelBase.cs</code> file:</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.ComponentModel</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ComboBoxMVVMExample.ViewModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">ViewModelBase</span> <span class="p">:</span> <span class="n">INotifyPropertyChanged</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="nf">Conditional</span><span class="p">(</span><span class="s">"DEBUG"</span><span class="p">)]</span>
        <span class="p">[</span><span class="n">DebuggerStepThrough</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">VerifyPropertyName</span><span class="p">(</span><span class="kt">string</span> <span class="n">propertyName</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">TypeDescriptor</span><span class="p">.</span><span class="nf">GetProperties</span><span class="p">(</span><span class="k">this</span><span class="p">)[</span><span class="n">propertyName</span><span class="p">]</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">string</span> <span class="n">msg</span> <span class="p">=</span> <span class="s">"Invalid property name: "</span> <span class="p">+</span> <span class="n">propertyName</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">ThrowOnInvalidPropertyName</span><span class="p">)</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
                <span class="k">else</span>
                    <span class="n">Debug</span><span class="p">.</span><span class="nf">Fail</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">protected</span> <span class="k">virtual</span> <span class="kt">bool</span> <span class="n">ThrowOnInvalidPropertyName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">private</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">RaisePropertyChanged</span><span class="p">(</span><span class="kt">string</span> <span class="n">propertyName</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nf">VerifyPropertyName</span><span class="p">(</span><span class="n">propertyName</span><span class="p">);</span>
            <span class="nf">OnPropertyChanged</span><span class="p">(</span><span class="n">propertyName</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="k">event</span> <span class="n">PropertyChangedEventHandler</span> <span class="n">PropertyChanged</span><span class="p">;</span>
        <span class="k">protected</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">OnPropertyChanged</span><span class="p">(</span><span class="kt">string</span> <span class="n">propertyName</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nf">VerifyPropertyName</span><span class="p">(</span><span class="n">propertyName</span><span class="p">);</span>
            <span class="n">PropertyChangedEventHandler</span> <span class="n">handler</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">PropertyChanged</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">handler</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">e</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PropertyChangedEventArgs</span><span class="p">(</span><span class="n">propertyName</span><span class="p">);</span>
                <span class="nf">handler</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The code inside <code class="highlighter-rouge">RelayCommand.cs</code> file:</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Input</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ComboBoxMVVMExample.ViewModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">RelayCommand</span> <span class="p">:</span> <span class="n">ICommand</span>
    <span class="p">{</span>
        <span class="k">readonly</span> <span class="n">Action</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">_execute</span><span class="p">;</span>
        <span class="k">readonly</span> <span class="n">Predicate</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">_canExecute</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">RelayCommand</span><span class="p">(</span><span class="n">Action</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">execute</span><span class="p">)</span>
            <span class="p">:</span> <span class="k">this</span><span class="p">(</span><span class="n">execute</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="nf">RelayCommand</span><span class="p">(</span><span class="n">Action</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">execute</span><span class="p">,</span> <span class="n">Predicate</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;</span> <span class="n">canExecute</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">execute</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="s">"execute"</span><span class="p">);</span>

            <span class="n">_execute</span> <span class="p">=</span> <span class="n">execute</span><span class="p">;</span>
            <span class="n">_canExecute</span> <span class="p">=</span> <span class="n">canExecute</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="p">[</span><span class="n">DebuggerStepThrough</span><span class="p">]</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">CanExecute</span><span class="p">(</span><span class="kt">object</span> <span class="n">parameters</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">_canExecute</span> <span class="p">==</span> <span class="k">null</span> <span class="p">?</span> <span class="k">true</span> <span class="p">:</span> <span class="nf">_canExecute</span><span class="p">(</span><span class="n">parameters</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="k">event</span> <span class="n">EventHandler</span> <span class="n">CanExecuteChanged</span>
        <span class="p">{</span>
            <span class="k">add</span> <span class="p">{</span> <span class="n">CommandManager</span><span class="p">.</span><span class="n">RequerySuggested</span> <span class="p">+=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">remove</span> <span class="p">{</span> <span class="n">CommandManager</span><span class="p">.</span><span class="n">RequerySuggested</span> <span class="p">-=</span> <span class="k">value</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Execute</span><span class="p">(</span><span class="kt">object</span> <span class="n">parameters</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nf">_execute</span><span class="p">(</span><span class="n">parameters</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>NOTE:</strong> You may copy-paste those code above into your files.</p>

<p>Now, we have finished with our basic classes that required for MVVM implementation to work without problem.</p>

<h2 id="creating-the-view">Creating the View</h2>

<p>Let’s start creating our View. Inside <strong>View</strong> folder, I have created a XAML (UserControl) file called <code class="highlighter-rouge">ComboBox.xaml</code>. The new project structure should look like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Solution 'ComboBoxMVVMExample' (1 project)
└── ComboBoxMVVMExample
	├── Properties
	├── References
	├── Model
	├── View
	|	└── ComboBox.xaml
	├── ViewModel
	|	├── RelayCommand.cs
	|	└── ViewModelBase.cs
	├── App.config
	├── App.xaml
	└── MainWindow.xaml
</code></pre>
</div>

<p>Inside <code class="highlighter-rouge">ComboBox.xaml</code> file, we design our XAML code into something like this:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;UserControl</span> <span class="na">x:Class=</span><span class="s">"ComboBoxMVVMExample.View.ComboBox"</span>
             <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
             <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
             <span class="na">xmlns:mc=</span><span class="s">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;StackPanel</span> <span class="na">Orientation=</span><span class="s">"Vertical"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;StackPanel</span> <span class="na">Orientation=</span><span class="s">"Horizontal"</span> <span class="na">Margin=</span><span class="s">"10"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Label</span> <span class="na">Content=</span><span class="s">"Get Enum items: "</span> <span class="na">Margin=</span><span class="s">"0 0 10 0"</span> <span class="na">Width=</span><span class="s">"120"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;ComboBox</span> <span class="na">Width=</span><span class="s">"120"</span> <span class="na">ItemsSource=</span><span class="s">"{Binding EnumItems}"</span> <span class="na">SelectedItem=</span><span class="s">"{Binding EnumSelectedItem}"</span> <span class="na">Margin=</span><span class="s">"0 0 10 0"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Button</span> <span class="na">Content=</span><span class="s">"Show Selected Item"</span> <span class="na">Command=</span><span class="s">"{Binding ShowEnumItemCommand}"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/StackPanel&gt;</span>

        <span class="nt">&lt;StackPanel</span> <span class="na">Orientation=</span><span class="s">"Horizontal"</span> <span class="na">Margin=</span><span class="s">"10"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Label</span> <span class="na">Content=</span><span class="s">"Get Country list: "</span> <span class="na">Margin=</span><span class="s">"0 0 10 0"</span> <span class="na">Width=</span><span class="s">"120"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;ComboBox</span> <span class="na">Width=</span><span class="s">"120"</span> <span class="na">ItemsSource=</span><span class="s">"{Binding CountryList}"</span> <span class="na">DisplayMemberPath=</span><span class="s">"CountryName"</span> <span class="na">SelectedValue=</span><span class="s">"{Binding SelectedCountryCode}"</span> <span class="na">SelectedValuePath=</span><span class="s">"CountryTwoLetterCode"</span> <span class="na">Margin=</span><span class="s">"0 0 10 0"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Label</span> <span class="na">Content=</span><span class="s">"{Binding SelectedCountryCode}"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/StackPanel&gt;</span>

        <span class="nt">&lt;StackPanel</span> <span class="na">Orientation=</span><span class="s">"Horizontal"</span> <span class="na">Margin=</span><span class="s">"10"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Label</span> <span class="na">Content=</span><span class="s">"Get State list: "</span> <span class="na">Margin=</span><span class="s">"0 0 10 0"</span> <span class="na">Width=</span><span class="s">"120"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;ComboBox</span> <span class="na">Width=</span><span class="s">"120"</span> <span class="na">ItemsSource=</span><span class="s">"{Binding StateList}"</span> <span class="na">DisplayMemberPath=</span><span class="s">"StateName"</span> <span class="na">SelectedValue=</span><span class="s">"{Binding SelectedState}"</span> <span class="na">SelectedValuePath=</span><span class="s">"StateName"</span> <span class="na">IsEnabled=</span><span class="s">"{Binding AllowStateSelection}"</span> <span class="na">Margin=</span><span class="s">"0 0 10 0"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Label</span> <span class="na">Content=</span><span class="s">"{Binding SelectedState}"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/StackPanel&gt;</span>
    <span class="nt">&lt;/StackPanel&gt;</span>
<span class="nt">&lt;/UserControl&gt;</span>
</code></pre>
</div>

<p>Inside here, I have added three ComboBox elements. The first ComboBox is for <code class="highlighter-rouge">enum</code>-type list. This is just an example of binding the <code class="highlighter-rouge">ICommand</code> interface and use of <code class="highlighter-rouge">RelayCommand</code> later. Another two ComboBox elements are an example of the cascaded ComboBox using <code class="highlighter-rouge">List&lt;T&gt;</code> class.</p>

<p>Here’s how the GUI will look:</p>

<p><img src="http://i.imgur.com/OjRjTdJ.png" alt="Screenshot" /></p>

<h3 id="selecteditem-selectedvalue-selectedvaluepath-and-displaymemberpath">SelectedItem, SelectedValue, SelectedValuePath and DisplayMemberPath</h3>

<p>If you notice that inside ComboBox there are some parameters have been used such as <code class="highlighter-rouge">SelectedItem</code>, <code class="highlighter-rouge">SelectedValue</code>, <code class="highlighter-rouge">SelectedValuePath</code>, and <code class="highlighter-rouge">DisplayMemberPath</code>. So, what are the differences?</p>

<ul>
  <li><strong>SelectedItem:</strong> This will return the currently selected item in the List/ComboBox/container. This is an object as you can see. If your List/ComboBox/etc. contains a list of strings, it’ll be a string. If it contains integers, it’ll be an integer (int).</li>
  <li><strong>SelectedValue:</strong> If we want only a part of an object, set the property and you’ll get the value of that property. Please note that, if <code class="highlighter-rouge">SelectedValuePath</code> is not used, this is the same as using <code class="highlighter-rouge">SelectedItem</code>.</li>
  <li><strong>SelectedValuePath:</strong> Setting this will make the property <code class="highlighter-rouge">SelectedValue</code> returns the value of the property we have selected. In our example, selecting “CountryTwoLetterCode” will make the <code class="highlighter-rouge">SelectedValue</code> returns only the two-letter code, not the whole country object.</li>
  <li><strong>DisplayMemberPath:</strong> Setting this to a property of an object to be displayed on GUI.</li>
</ul>

<h2 id="creating-the-model">Creating the Model</h2>

<p>After we’re done with the View, now we need to design our data model. Let’s start creating an example model class file called <code class="highlighter-rouge">ExampleModel.cs</code> inside our <strong>Model</strong> folder. So, the new project structure should look like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Solution 'ComboBoxMVVMExample' (1 project)
└── ComboBoxMVVMExample
	├── Properties
	├── References
	├── Model
	|	└── ExampleModel.cs
	├── View
	|	└── ComboBox.xaml
	├── ViewModel
	|	├── RelayCommand.cs
	|	└── ViewModelBase.cs
	├── App.config
	├── App.xaml
	└── MainWindow.xaml
</code></pre>
</div>

<p>Here’s the code inside <code class="highlighter-rouge">ExampleModel.cs</code> file:</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ComboBoxMVVMExample.ViewModel</span><span class="p">;</span> <span class="c1">// ViewModelBase.cs
</span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span> <span class="c1">// List&lt;Country&gt;
</span>
<span class="k">namespace</span> <span class="nn">ComboBoxMVVMExample.Model</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ExampleModel</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">enum</span> <span class="n">EnumItem</span>
    <span class="p">{</span>
        <span class="n">Enum01</span><span class="p">,</span>
        <span class="n">Enum02</span><span class="p">,</span>
        <span class="n">Enum03</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Country</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">CountryName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">CountryTwoLetterCode</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Country</span><span class="p">&gt;</span> <span class="nf">getCountries</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">List</span><span class="p">&lt;</span><span class="n">Country</span><span class="p">&gt;</span> <span class="n">returnCountries</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Country</span><span class="p">&gt;();</span>
            <span class="n">returnCountries</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">Country</span><span class="p">()</span> <span class="p">{</span> <span class="n">CountryName</span> <span class="p">=</span> <span class="s">"United States"</span><span class="p">,</span> <span class="n">CountryTwoLetterCode</span> <span class="p">=</span> <span class="s">"US"</span> <span class="p">});</span>
            <span class="n">returnCountries</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">Country</span><span class="p">()</span> <span class="p">{</span> <span class="n">CountryName</span> <span class="p">=</span> <span class="s">"Malaysia"</span><span class="p">,</span> <span class="n">CountryTwoLetterCode</span> <span class="p">=</span> <span class="s">"MY"</span> <span class="p">});</span>
            <span class="n">returnCountries</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">Country</span><span class="p">()</span> <span class="p">{</span> <span class="n">CountryName</span> <span class="p">=</span> <span class="s">"India"</span><span class="p">,</span> <span class="n">CountryTwoLetterCode</span> <span class="p">=</span> <span class="s">"IN"</span> <span class="p">});</span>
            <span class="k">return</span> <span class="n">returnCountries</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">State</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">CountryTwoLetterCode</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">StateName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">State</span><span class="p">&gt;</span> <span class="nf">getStatesCollection</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">List</span><span class="p">&lt;</span><span class="n">State</span><span class="p">&gt;</span> <span class="n">returnStates</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">State</span><span class="p">&gt;();</span>
            <span class="n">returnStates</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">State</span><span class="p">()</span> <span class="p">{</span> <span class="n">CountryTwoLetterCode</span> <span class="p">=</span> <span class="s">"US"</span><span class="p">,</span> <span class="n">StateName</span> <span class="p">=</span> <span class="s">"New York"</span> <span class="p">});</span>
            <span class="n">returnStates</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">State</span><span class="p">()</span> <span class="p">{</span> <span class="n">CountryTwoLetterCode</span> <span class="p">=</span> <span class="s">"US"</span><span class="p">,</span> <span class="n">StateName</span> <span class="p">=</span> <span class="s">"Alaska"</span> <span class="p">});</span>
            <span class="n">returnStates</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">State</span><span class="p">()</span> <span class="p">{</span> <span class="n">CountryTwoLetterCode</span> <span class="p">=</span> <span class="s">"US"</span><span class="p">,</span> <span class="n">StateName</span> <span class="p">=</span> <span class="s">"West Virginia"</span> <span class="p">});</span>
            <span class="n">returnStates</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">State</span><span class="p">()</span> <span class="p">{</span> <span class="n">CountryTwoLetterCode</span> <span class="p">=</span> <span class="s">"MY"</span><span class="p">,</span> <span class="n">StateName</span> <span class="p">=</span> <span class="s">"Kelantan"</span> <span class="p">});</span>
            <span class="n">returnStates</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">State</span><span class="p">()</span> <span class="p">{</span> <span class="n">CountryTwoLetterCode</span> <span class="p">=</span> <span class="s">"MY"</span><span class="p">,</span> <span class="n">StateName</span> <span class="p">=</span> <span class="s">"Pulau Pinang"</span> <span class="p">});</span>
            <span class="n">returnStates</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">State</span><span class="p">()</span> <span class="p">{</span> <span class="n">CountryTwoLetterCode</span> <span class="p">=</span> <span class="s">"MY"</span><span class="p">,</span> <span class="n">StateName</span> <span class="p">=</span> <span class="s">"Selangor"</span> <span class="p">});</span>
            <span class="n">returnStates</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">State</span><span class="p">()</span> <span class="p">{</span> <span class="n">CountryTwoLetterCode</span> <span class="p">=</span> <span class="s">"IN"</span><span class="p">,</span> <span class="n">StateName</span> <span class="p">=</span> <span class="s">"Mumbai"</span> <span class="p">});</span>
            <span class="k">return</span> <span class="n">returnStates</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">State</span><span class="p">&gt;</span> <span class="nf">getStateByCountryCode</span><span class="p">(</span><span class="kt">string</span> <span class="n">countryCode</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">List</span><span class="p">&lt;</span><span class="n">State</span><span class="p">&gt;</span> <span class="n">stateList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">State</span><span class="p">&gt;();</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="n">State</span> <span class="n">currentState</span> <span class="k">in</span> <span class="nf">getStatesCollection</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">currentState</span><span class="p">.</span><span class="n">CountryTwoLetterCode</span> <span class="p">==</span> <span class="n">countryCode</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">stateList</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">State</span><span class="p">()</span> <span class="p">{</span> <span class="n">CountryTwoLetterCode</span> <span class="p">=</span> <span class="n">currentState</span><span class="p">.</span><span class="n">CountryTwoLetterCode</span><span class="p">,</span> <span class="n">StateName</span> <span class="p">=</span> <span class="n">currentState</span><span class="p">.</span><span class="n">StateName</span> <span class="p">});</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">stateList</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>We can create different class file for each object. But, here I just use the same class file only and put inside all of the objects. As you can see from the code above, we have three objects; <code class="highlighter-rouge">EnumItem</code>, <code class="highlighter-rouge">Country</code>, and <code class="highlighter-rouge">State</code>. Please go through the code and understand them.</p>

<p>Here are the hints:-</p>

<ul>
  <li><code class="highlighter-rouge">CountryName</code>, <code class="highlighter-rouge">CountryTwoLetterCode</code> and <code class="highlighter-rouge">StateName</code> are the properties of the respective objects (Country and State).</li>
  <li><code class="highlighter-rouge">getCountries()</code> and <code class="highlighter-rouge">getStatesCollection()</code> are the instantiation methods used to get a list of Country and State respectively.</li>
  <li><code class="highlighter-rouge">getStateByCountryCode(X)</code> is a method to get a list of states based on a particular country’s two-letter code.</li>
  <li><code class="highlighter-rouge">EnumItem</code> class is just an example of a list using enum type.</li>
</ul>

<h2 id="creating-the-viewmodel">Creating the ViewModel</h2>

<p>Now comes to the ‘glue’ part. Let’s create a view model class file inside <strong>ViewModel</strong> folder, e.g. <code class="highlighter-rouge">ExampleViewModel.cs</code>. Here is how the new project structure will look:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Solution 'ComboBoxMVVMExample' (1 project)
└── ComboBoxMVVMExample
	├── Properties
	├── References
	├── Model
	|	└── ExampleModel.cs
	├── View
	|	└── ComboBox.xaml
	├── ViewModel
	|	├── ExampleViewModel.cs
	|	├── RelayCommand.cs
	|	└── ViewModelBase.cs
	├── App.config
	├── App.xaml
	└── MainWindow.xaml
</code></pre>
</div>

<p>Below is how the code looks like inside <code class="highlighter-rouge">ExampleViewModel.cs</code> file. No need for me to explain much as I put some comments beside the code and the code itself should be at least, self-explainable.</p>

<div class="language-csharp highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ComboBoxMVVMExample.Model</span><span class="p">;</span> <span class="c1">// ExampleEnum
</span><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span> <span class="c1">// IEnumerable
</span><span class="k">using</span> <span class="nn">System.Windows</span><span class="p">;</span> <span class="c1">// MessageBox
</span><span class="k">using</span> <span class="nn">System.Windows.Input</span><span class="p">;</span> <span class="c1">// ICommand
</span><span class="k">using</span> <span class="nn">System.Collections.ObjectModel</span><span class="p">;</span> <span class="c1">// ObservableCollection&lt;Country&gt;
</span>

<span class="k">namespace</span> <span class="nn">ComboBoxMVVMExample.ViewModel</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;
</span>    <span class="c1">/// This class inherits from ViewModelBase class
</span>    <span class="c1">/// &lt;/summary&gt;
</span>    <span class="k">public</span> <span class="k">class</span> <span class="nc">ExampleViewModel</span> <span class="p">:</span> <span class="n">ViewModelBase</span>
    <span class="p">{</span>
        <span class="err">#</span><span class="n">region</span> <span class="n">ComboBox</span> <span class="k">using</span> <span class="nn">enum</span> <span class="n">type</span>
        <span class="c1">// Private Fields
</span>        <span class="k">private</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">EnumItem</span><span class="p">&gt;</span> <span class="n">_EnumItems</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">_EnumSelectedItem</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">ICommand</span> <span class="n">_ShowEnumItemCommand</span><span class="p">;</span>

        <span class="c1">// Public Properties - Used for binding with the View
</span>        <span class="k">public</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">EnumItem</span><span class="p">&gt;</span> <span class="n">EnumItems</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span>
                <span class="c1">// Whatever type of the enum, return them the same too
</span>                <span class="k">return</span> <span class="p">(</span><span class="n">EnumItem</span><span class="p">[])</span><span class="n">Enum</span><span class="p">.</span><span class="nf">GetValues</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">EnumItem</span><span class="p">));</span>
            <span class="p">}</span>
            <span class="k">set</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">value</span> <span class="p">!=</span> <span class="n">_EnumItems</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">_EnumItems</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                    <span class="nf">OnPropertyChanged</span><span class="p">(</span><span class="s">"EnumItems"</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">EnumSelectedItem</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_EnumSelectedItem</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">set</span>
            <span class="p">{</span>
                <span class="n">_EnumSelectedItem</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="nf">OnPropertyChanged</span><span class="p">(</span><span class="s">"EnumSelectedItem"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="n">ICommand</span> <span class="n">ShowEnumItemCommand</span>
        <span class="p">{</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="n">_ShowEnumItemCommand</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RelayCommand</span><span class="p">(</span>
                    <span class="n">param</span> <span class="p">=&gt;</span> <span class="nf">ShowEnumItemMethod</span><span class="p">()</span>
                <span class="p">);</span>
                <span class="k">return</span> <span class="n">_ShowEnumItemCommand</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// Private Method
</span>        <span class="k">private</span> <span class="k">void</span> <span class="nf">ShowEnumItemMethod</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Get combobox current selected value
</span>            <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Show</span><span class="p">(</span><span class="n">EnumSelectedItem</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">Cascaded</span> <span class="n">ComboBox</span> <span class="k">using</span> <span class="nn">List</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="k">class</span>
        <span class="c1">// Private Fields
</span>        <span class="nc">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Country</span><span class="p">&gt;</span> <span class="n">_CountryList</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">_SelectedCountryCode</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">State</span><span class="p">&gt;</span> <span class="n">_StateList</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">_SelectedState</span><span class="p">;</span>

        <span class="c1">// Public Properties - Used for binding with the View
</span>        <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Country</span><span class="p">&gt;</span> <span class="n">CountryList</span> <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_CountryList</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">set</span>
            <span class="p">{</span>
                <span class="n">_CountryList</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="nf">OnPropertyChanged</span><span class="p">(</span><span class="s">"CountryList"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">SelectedCountryCode</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_SelectedCountryCode</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">set</span>
            <span class="p">{</span>
                <span class="n">_SelectedCountryCode</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="nf">OnPropertyChanged</span><span class="p">(</span><span class="s">"SelectedCountryCode"</span><span class="p">);</span>
                <span class="nf">OnPropertyChanged</span><span class="p">(</span><span class="s">"AllowStateSelection"</span><span class="p">);</span> <span class="c1">// Trigger Enable/Disable UI element when particular country is selected
</span>                <span class="nf">getStateList</span><span class="p">();</span> <span class="c1">// Generate a new list of states based on a selected country
</span>            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">State</span><span class="p">&gt;</span> <span class="n">StateList</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_StateList</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">set</span>
            <span class="p">{</span>
                <span class="n">_StateList</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="nf">OnPropertyChanged</span><span class="p">(</span><span class="s">"StateList"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">SelectedState</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_SelectedState</span><span class="p">;</span> <span class="p">}</span>
            <span class="k">set</span>
            <span class="p">{</span>
                <span class="n">_SelectedState</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="nf">OnPropertyChanged</span><span class="p">(</span><span class="s">"SelectedState"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="n">AllowStateSelection</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="p">(</span><span class="n">SelectedCountryCode</span> <span class="p">!=</span> <span class="k">null</span><span class="p">);</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// Constructor
</span>        <span class="k">public</span> <span class="nf">ExampleViewModel</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Instantiate, get a list of countries from the Model
</span>            <span class="n">Country</span> <span class="n">_Country</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Country</span><span class="p">();</span>
            <span class="n">CountryList</span> <span class="p">=</span> <span class="n">_Country</span><span class="p">.</span><span class="nf">getCountries</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="c1">// Private Method
</span>        <span class="k">private</span> <span class="k">void</span> <span class="nf">getStateList</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Instantiate, get a list of states based on selected country two-letter code from the Model
</span>            <span class="n">State</span> <span class="n">_State</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">State</span><span class="p">();</span>
            <span class="n">StateList</span> <span class="p">=</span> <span class="n">_State</span><span class="p">.</span><span class="nf">getStateByCountryCode</span><span class="p">(</span><span class="n">SelectedCountryCode</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p><strong>NOTE:</strong> Check the project source code for better code documentations.</p>

<p>Now we’re finished with the ViewModel. We have everything what we want in place. Basically, the public properties in ViewModel are used to bind with the View. In order for the ViewModel to participate in two-way data binding with the View, its properties must raise the <strong>PropertyChanged</strong> event. In my case here is <code class="highlighter-rouge">OnPropertyChanged("PropertyName");</code>.</p>

<p>View model satisfy this requirement by implementing the <a href="https://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx">INotifyPropertyChanged</a> interface and raising the <strong>PropertyChanged</strong> event when a property is changed. Listeners can respond appropriately to the property changes when they occur. You can learn more and go through the code inside <code class="highlighter-rouge">ViewModelBase.cs</code> file. As you should notice, it inherits <strong>INotifyPropertyChanged</strong> interface at the first place.</p>

<h2 id="connecting-the-viewmodel-to-the-view">Connecting the ViewModel to the View</h2>

<p>There are many approaches to connect a view model to a view, including direct relations and container-based approaches. However, all share the same aim, which is for the view to have a view model assigned to its <strong>DataContext</strong> property. Views can be connected to view models in a code-behind file, or in the view itself.</p>

<p>In this example, I connect it using the view itself. So, I don’t need to touch the code-behind file. Check the XAML code in <code class="highlighter-rouge">MainWindow.xaml</code> file below:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;Window</span> <span class="na">x:Class=</span><span class="s">"ComboBoxMVVMExample.MainWindow"</span>
        <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
        <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
        <span class="na">xmlns:view=</span><span class="s">"clr-namespace:ComboBoxMVVMExample.View"</span>
        <span class="na">xmlns:viewModel=</span><span class="s">"clr-namespace:ComboBoxMVVMExample.ViewModel"</span>
        <span class="na">Title=</span><span class="s">"MainWindow"</span> <span class="na">Height=</span><span class="s">"350"</span> <span class="na">Width=</span><span class="s">"525"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Window.DataContext&gt;</span>
        <span class="nt">&lt;viewModel:ExampleViewModel/&gt;</span>
    <span class="nt">&lt;/Window.DataContext&gt;</span>
    <span class="nt">&lt;Grid&gt;</span>

    <span class="nt">&lt;/Grid&gt;</span>
<span class="nt">&lt;/Window&gt;</span>
</code></pre>
</div>

<p>As you can see from the XAML above, I add two new namespaces called <code class="highlighter-rouge">view</code> and <code class="highlighter-rouge">viewModel</code>. From there, I can use <code class="highlighter-rouge">Window.DataContext</code> to point out to <code class="highlighter-rouge">ExampleViewModel</code> class.</p>

<p>If we compile the project, for sure it will show nothing because we are not yet include our View (<code class="highlighter-rouge">ComboBox.xaml</code>). So, for the last one, let’s include it.</p>

<p>Final look of <code class="highlighter-rouge">MainWindow.xaml</code> file:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;Window</span> <span class="na">x:Class=</span><span class="s">"ComboBoxMVVMExample.MainWindow"</span>
        <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
        <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
        <span class="na">xmlns:view=</span><span class="s">"clr-namespace:ComboBoxMVVMExample.View"</span>
        <span class="na">xmlns:viewModel=</span><span class="s">"clr-namespace:ComboBoxMVVMExample.ViewModel"</span>
        <span class="na">Title=</span><span class="s">"MainWindow"</span> <span class="na">Height=</span><span class="s">"350"</span> <span class="na">Width=</span><span class="s">"525"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Window.DataContext&gt;</span>
        <span class="nt">&lt;viewModel:ExampleViewModel/&gt;</span>
    <span class="nt">&lt;/Window.DataContext&gt;</span>

    <span class="nt">&lt;Grid&gt;</span>
        <span class="nt">&lt;StackPanel</span> <span class="na">Orientation=</span><span class="s">"Vertical"</span> <span class="na">HorizontalAlignment=</span><span class="s">"Center"</span> <span class="na">VerticalAlignment=</span><span class="s">"Center"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;view:ComboBox/&gt;</span>
        <span class="nt">&lt;/StackPanel&gt;</span>
    <span class="nt">&lt;/Grid&gt;</span>

<span class="nt">&lt;/Window&gt;</span>
</code></pre>
</div>

<p>Compile again and we should be able to see our ComboBox design. At first, nothing is selected, so ComboBox for <strong>State</strong> will be disabled. But, whenever I started select a <strong>Country</strong>, e.g. Malaysia, the ComboBox for <strong>State</strong> will be enabled, instantiated and populate a list of example states in Malaysia.</p>

<p><img src="http://i.imgur.com/LlC4BmP.png" alt="Final Result" /></p>

<p>That’s it! Please open the project in Visual Studio for better understanding of this tutorial.</p>

<p><a href="https://github.com/heiswayi/ComboBoxMVVMExample/archive/master.zip"><strong>Download Source Code</strong></a> on <a href="https://github.com/heiswayi/ComboBoxMVVMExample">GitHub</a></p>

<h2 id="fyi-the-benefits-of-mvvm">FYI, The Benefits of MVVM</h2>

<p>MVVM enables a great developer-designer workflow, providing these benefits:</p>

<ul>
  <li>During the development process, developers and designers can work more independently and concurrently on their components. The designers can concentrate on the view, and if they are using Expression Blend, they can easily generate sample data to work with, while the developers can work on the view model and model components.</li>
  <li>The developers can create unit tests for the view model and the model without using the view. The unit tests for the view model can exercise exactly the same functionality as used by the view.</li>
  <li>It is easy to redesign the UI of the application without touching the code because the view is implemented entirely in XAML. A new version of the view should work with the existing view model.</li>
  <li>If there is an existing implementation of the model that encapsulates existing business logic, it may be difficult or risky to change. In this scenario, the view model acts as an adapter for the model classes and enables you to avoid making any major changes to the model code.</li>
</ul>

<p>Have fun coding!</p>

  
</div>
<div class="back"><a href="/notes.html"><i class="fa fa-chevron-left"></i> Back</a></div>

      </div>
    </div>

	  <div class="footer">
	<div class="hrline"></div>
	<div class="license">Unless otherwise stated, all original code presented on this site is licensed under the <a href="http://heiswayi.github.io/mit-license">MIT license</a>. All original photographs and text on this website are licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives</a> license. If you have any questions about using any of this material for commercial purposes, please <a href="https://github.com/heiswayi/ama">ask me here</a> or <a href="mailto:asd@gmail.com">write an email to me</a>.</div>
	<div class="copyright">Made with <span style="color:#e00"><i class="fa fa-heart"></i></span> using <a href="http://jekyllrb.com">Jekyll</a> &middot; <i class="fa fa-code"></i> on <a href="https://github.com/heiswayi/heiswayi.github.io_jekyll_source">GitHub</a> <i class="fa fa-github-alt"></i><br>&copy; 2016 Heiswayi Nrird</div>
</div>

<script>
$(window).load(function() {
	$('.grid').masonry({
		itemSelector: '.grid-item',
		columnWidth: '.grid-sizer',
		gutter: 10
	});
});
</script>


	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-58296043-7', 'auto');
  ga('send', 'pageview');
</script>




  </body>
</html>
